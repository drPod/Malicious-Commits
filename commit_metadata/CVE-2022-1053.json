{
  "keylime": [
    {
      "hash": "7fc63fdaef67a09a79ff37e82b0de9e601c483f0",
      "author": "Ivan Font",
      "author_email": "ifont@redhat.com",
      "committed_date": "2020-07-24T13:00:15+01:00",
      "message": "Update verifier REST API to return error for invalid exclude list (#319)\n\nThis updates the verifier REST API to return a 400 error code\r\nimmediately i.e. instead of adding the agent, if the verifier receives a\r\nPOST request e.g. from keylime_tenant, with agent data that contains an\r\ninvalid exclude list regular expression.",
      "files_changed": [
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/common.py",
        "keylime/ima.py",
        "keylime/tenant.py",
        "test/test_restful.py"
      ],
      "insertions": 84,
      "deletions": 12,
      "original_hash": "7fc63fdaef67a09a79ff37e82b0de9e601c483f0",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "9de329a7994a3e419dd63592a746c27c6313281b",
      "author": "Luke Hinds",
      "author_email": "lhinds@redhat.com",
      "committed_date": "2019-11-28T22:36:20+00:00",
      "message": "Revert \"Revert \"Merge branch 'master' of github.com:keylime/keylime\"\"\n\nThis reverts commit 1c367cfaa1d893f275f06563fa76a079a76406ac.",
      "files_changed": [
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/revocation_notifier.py",
        "keylime/tenant.py",
        "keylime/tornado_requests.py"
      ],
      "insertions": 220,
      "deletions": 191,
      "original_hash": "9de329a7994a3e419dd63592a746c27c6313281b",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "e6703aafd4619c7755f5b77357045cfec50b4fc9",
      "author": "Thore Sommer",
      "author_email": "mail@thson.de",
      "committed_date": "2021-09-13T17:02:28-04:00",
      "message": "verifier: move to new failure architecture\n\nWe only send notifications if a event with a higher severity level was\ngenerated and save the severity level (as integer) and the first event id\nthat generated the failure with that level in the database.\n\nThe current design assumes that when a device is added no failures should\noccur on the first validation to mark the device as in use to recive\nrevocation notifcations.\n\nIf a failure is generated that is irrecoverable we stop polling the agent.\n\nPart of enhancement proposal keylime/enhancements#48\n\nSigned-off-by: Thore Sommer <mail@thson.de>",
      "files_changed": [
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/db/verifier_db.py",
        "keylime/migrations/versions/257fe0f0c039_add_fields_for_revocation_context_to_.py"
      ],
      "insertions": 149,
      "deletions": 56,
      "original_hash": "e6703aafd4619c7755f5b77357045cfec50b4fc9",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "70b73bc78f3c4f5d6d994c785dae294377aa7192",
      "author": "Angelo Ruocco",
      "author_email": "ang@zurich.ibm.com",
      "committed_date": "2022-02-01T14:48:18+01:00",
      "message": "cloud verifier: add exponential backoff option to retry timings\n\nSigned-off-by: Angelo Ruocco <ang@zurich.ibm.com>",
      "files_changed": [
        "keylime.conf",
        "keylime/cloud_verifier_tornado.py",
        "keylime/revocation_notifier.py"
      ],
      "insertions": 30,
      "deletions": 16,
      "original_hash": "70b73bc78f3c4f5d6d994c785dae294377aa7192",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "3fce9940254419f805a8b10ef981fa45f25f7d62",
      "author": "Kaifeng Wang",
      "author_email": "kaifeng.w@gmail.com",
      "committed_date": "2020-11-05T10:22:50-05:00",
      "message": "Missing return in CV API\n\nDELETE /agents and PUT /agents are missing return control and run\ninto unintended path.",
      "files_changed": [
        "keylime/cloud_verifier_tornado.py"
      ],
      "insertions": 3,
      "deletions": 0,
      "original_hash": "3fce9940254419f805a8b10ef981fa45f25f7d62",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "a78ebb2aa0ee9afe3c99bbe010b6cb44d8dc4f84",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.ibm.com",
      "committed_date": "2021-07-29T16:37:42-04:00",
      "message": "verifier: Delete an AgentAttestState when deleting an agent\n\nDelete the AgentAttestState associated with an agent_id when the\nagent is deleted from the database.\n\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/cloud_verifier_tornado.py"
      ],
      "insertions": 9,
      "deletions": 6,
      "original_hash": "a78ebb2aa0ee9afe3c99bbe010b6cb44d8dc4f84",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "5bcd88dd566865086885ac3b3eec88b35ea06bbf",
      "author": "nabil",
      "author_email": "nabil@ll.mit.edu",
      "committed_date": "2017-07-20T15:55:02-04:00",
      "message": "adding revocation notifier, tenant webapp, demos, ima stub.  Various bug fixes and other enhancements.",
      "files_changed": [
        "README.md",
        "demo/README.md",
        "demo/demo_setup.sh",
        "demo/ima-policy",
        "demo/keyfile.txt",
        "demo/mount.sh",
        "demo/node_monitor/README.md",
        "demo/node_monitor/mount.sh",
        "demo/node_monitor/tenant_node_monitor.py",
        "demo/node_monitor/tenant_node_monitor.sh",
        "demo/payload.enc",
        "demo/payload.txt",
        "demo/payload/index.html",
        "demo/payload/vault.jpg",
        "doc/keylime RESTful API.docx",
        "ima_stub_service/README.md",
        "ima_stub_service/installer.sh",
        "ima_stub_service/tpm_emulator.service",
        "ima_stub_service/tpm_with_ima.sh",
        "installer.sh",
        "keylime.conf",
        "keylime/.gitignore",
        "keylime/ca_impl_cfssl.py",
        "keylime/ca_impl_openssl.py",
        "keylime/ca_util.py",
        "keylime/cloud_node.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/cn_installer.spec",
        "keylime/common.py",
        "keylime/create_whitelist.sh",
        "keylime/crypto.py",
        "keylime/dev-clean.sh",
        "keylime/ima.py",
        "keylime/ima_emulator_adapter.py",
        "keylime/keylime_sqlite.py",
        "keylime/make_node_bundle_tarball.sh",
        "keylime/provider_platform_init.py",
        "keylime/provider_registrar.py",
        "keylime/provider_vtpm_add.py",
        "keylime/registrar.py",
        "keylime/registrar_client.py",
        "keylime/registrar_common.py",
        "keylime/revocation_actions/__init__.py",
        "keylime/revocation_actions/print_metadata.py",
        "keylime/revocation_actions/update_crl.py",
        "keylime/revocation_notifier.py",
        "keylime/secure_mount.py",
        "keylime/serve_uuid.py",
        "keylime/static/css/webapp.css",
        "keylime/static/icons/ICON-LICENSE",
        "keylime/static/icons/README.md",
        "keylime/static/icons/png/ban-2x.png",
        "keylime/static/icons/png/ban-3x.png",
        "keylime/static/icons/png/ban-4x.png",
        "keylime/static/icons/png/ban-6x.png",
        "keylime/static/icons/png/ban-8x.png",
        "keylime/static/icons/png/ban.png",
        "keylime/static/icons/png/bug-2x.png",
        "keylime/static/icons/png/bug-3x.png",
        "keylime/static/icons/png/bug-4x.png",
        "keylime/static/icons/png/bug-6x.png",
        "keylime/static/icons/png/bug-8x.png",
        "keylime/static/icons/png/bug.png",
        "keylime/static/icons/png/keylime.png",
        "keylime/static/icons/png/plus-2x.png",
        "keylime/static/icons/png/plus-3x.png",
        "keylime/static/icons/png/plus-4x.png",
        "keylime/static/icons/png/plus-6x.png",
        "keylime/static/icons/png/plus-8x.png",
        "keylime/static/icons/png/plus.png",
        "keylime/static/icons/png/trash-2x.png",
        "keylime/static/icons/png/trash-3x.png",
        "keylime/static/icons/png/trash-4x.png",
        "keylime/static/icons/png/trash-6x.png",
        "keylime/static/icons/png/trash-8x.png",
        "keylime/static/icons/png/trash.png",
        "keylime/static/js/webapp.js",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py",
        "keylime/tornado_requests.py",
        "keylime/tpm_initialize.py",
        "keylime/tpm_quote.py",
        "keylime/tpm_random.py",
        "patches/opensslconf-patch.txt",
        "patches/tpm4720-patch.txt",
        "patches/trustedgrub-patch.txt",
        "scripts/.gitignore",
        "setup.py"
      ],
      "insertions": 5161,
      "deletions": 5948,
      "original_hash": "5bcd88dd566865086885ac3b3eec88b35ea06bbf",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "172afa2dd7bbcd42e6a3ff2f017ed51d8ec7f2c5",
      "author": "Apoorve Mohan",
      "author_email": "apoorvemohan@gmail.com",
      "committed_date": "2021-06-08T13:06:10-04:00",
      "message": "enable tenant to fetch all (or verifier specific) agents info in a single call from the verifier\n\nSigned-off-by: Apoorve Mohan <apoorvemohan@gmail.com>",
      "files_changed": [
        "keylime/cloud_verifier_tornado.py",
        "keylime/tenant.py"
      ],
      "insertions": 42,
      "deletions": 11,
      "original_hash": "172afa2dd7bbcd42e6a3ff2f017ed51d8ec7f2c5",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "cc5efe3e64f71daab41dd54c676759db75499e80",
      "author": "Kaifeng Wang",
      "author_email": "kaifeng.w@gmail.com",
      "committed_date": "2020-12-10T10:41:33-05:00",
      "message": "Rename common to config\n\nSo that we will have a common directory to hold common codes,\nthe previous common is actually a mix with configurations, debug\nflags, helpers. We can further move those helpers into common module\nand let conf only handles configurations.\n\nAlso rename utils/ to common/",
      "files_changed": [
        "archive/script_check_quote.py",
        "archive/script_check_quote_raw.py",
        "archive/script_create_quote.py",
        "auto-ipsec/libreswan/src/local_action_crashsa.py",
        "auto-ipsec/libreswan/src/local_action_update_crl.py",
        "auto-ipsec/racoon/src/local_action_deletesa.py",
        "auto-ipsec/racoon/src/local_action_update_crl.py",
        "keylime/ca_impl_cfssl.py",
        "keylime/ca_impl_openssl.py",
        "keylime/ca_util.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/cmd/ima_emulator_adapter.py",
        "keylime/cmd/provider_platform_init.py",
        "keylime/cmd/provider_registrar.py",
        "keylime/cmd/provider_vtpm_add.py",
        "keylime/cmd/registrar.py",
        "keylime/cmd/verifier.py",
        "keylime/common.py",
        "keylime/common/__init__.py",
        "keylime/common/algorithms.py",
        "keylime/config.py",
        "keylime/db/keylime_db.py",
        "keylime/ima.py",
        "keylime/keylime_agent.py",
        "keylime/keylime_logging.py",
        "keylime/registrar_client.py",
        "keylime/registrar_common.py",
        "keylime/revocation_actions/print_metadata.py",
        "keylime/revocation_actions/update_crl.py",
        "keylime/revocation_notifier.py",
        "keylime/secure_mount.py",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py",
        "keylime/tpm/tpm1.py",
        "keylime/tpm/tpm2.py",
        "keylime/tpm/tpm_abstract.py",
        "keylime/tpm/tpm_obj.py",
        "keylime/tpm_ek_ca.py",
        "keylime/utils/__init__.py",
        "keylime/utils/algorithms.py",
        "keylime/vtpm_manager.py",
        "test/test_restful.py"
      ],
      "insertions": 811,
      "deletions": 827,
      "original_hash": "cc5efe3e64f71daab41dd54c676759db75499e80",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "7ffb052d1c23071d2ea2f3c5ab504c6f7e19e5cc",
      "author": "Michael Peters",
      "author_email": "mpeters@redhat.com",
      "committed_date": "2021-07-28T09:36:21-04:00",
      "message": "Versioned APIs\n\nPer Enhancement #45\n\nSigned-off-by: Michael Peters <mpeters@redhat.com>",
      "files_changed": [
        "keylime/api_version.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/config.py",
        "keylime/keylime_agent.py",
        "keylime/registrar_client.py",
        "keylime/registrar_common.py",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py",
        "requirements.txt",
        "test/test_api_version.py",
        "test/test_restful.py"
      ],
      "insertions": 326,
      "deletions": 77,
      "original_hash": "7ffb052d1c23071d2ea2f3c5ab504c6f7e19e5cc",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "6bf36976228cc63ae0bc1a6b5f79a4b8ed4f0066",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.ibm.com",
      "committed_date": "2021-07-29T16:37:42-04:00",
      "message": "Introduce an AgentAttestState class for passing state through the APIs\n\nTo be able to support incremental attestation we need some sort of\ntracking the state of the PCRs and how far along we received the IMA\nmeasurement log so that we can continue the attestation where we left\noff the last time. The AgentAttestState keeps track of the attestation\nstate of the system where each agent is located.\n\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/agentstates.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/tenant.py",
        "keylime/tpm/tpm_abstract.py",
        "keylime/tpm/tpm_main.py"
      ],
      "insertions": 82,
      "deletions": 14,
      "original_hash": "6bf36976228cc63ae0bc1a6b5f79a4b8ed4f0066",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "b39d2824ffe0768daec2161e328a04d80e569108",
      "author": "Luke Hinds",
      "author_email": "lhinds@redhat.com",
      "committed_date": "2019-09-05T19:15:16+01:00",
      "message": "Python 3 Port\n\nPort from Python 2 to Python 3(.7). Numerous changes were made,\ntoo many to mention.\n\nThe list of full commits is retained below:\n\nFix tarball bundler scripts\nremove os.close\nfix ups for tpm2/tpm_abstract\nfix ups\nAsync support for tornado\nFurther updates\nAsync support for tornado, issues resolved\nCharlies IMA fixes\nFixes async performance issues and secure mount failure\nFutrher encoding fixes\nInclude register_client changes\nFix for commit screw up\nFixes Unexpected Provide V response error\nChanges moved to correct location\nFixes Unexpected Provide V response\nWorking encrypted payload\nRemove redundant async and fix unit tests\n--verify and payloads fixed\nAdd binary flag to open enc_path\nImplement CYaml Loader / Dumper\nImplement JSON again outside of crypto handling (its faster)\nImplement ozoder/logging-refactor\nFurther fixes to Keylime logging\nhttp.client exception handler added\nfix some codacy issues\nNabil fixes and other small changes\nPlaced import time back in\nFix for file write\nclean up erorr handling\npython3 updates\nfix raise to include exception\nwriting out the wrong key for ek.  fix bytes/str issue with key handle\nfixing up string/bytes\nlist wasn't working right\ncfssl implementation\nadding simplejson to setup.py.\n3.8 will maintain compat with ubuntu 16.04 and rhel/cent 7.  those are\nprobably the oldest distros we'll want.\nadding simple json.  helpful gopath message\nfedora 30 default to get proper go support\nWorking GUI\nAdded missing port values to keylime.conf\nclean up installer message\nstring encoding\nf-strings\navoid two ioloops\nnabil's favorite testing\ncare when openign files\nbytes conversion\nmove this log message into the costructor to avoid confusion\non tpm1 this would still appear in the log\nswitch cfssl to use requests\nunambiguous imports\npy3 encoding issues in revocation notifier\ntypo in import\navoid warning on error\nwhew that one was hard to fine, cfssl revoking now\nAdd retry / timeout handler and needed changes in tenant.py\nuse fstrings for http.client params\nremove last async call\nUpdated readme\nclean up installer\nFixes cloud_verifier_tornado KeyError issue\n\nFix tarball bundler scripts",
      "files_changed": [
        ".ci/test_wrapper.sh",
        "README.md",
        "auto-ipsec/libreswan/generate.py",
        "auto-ipsec/libreswan/src/local_action_crashsa.py",
        "auto-ipsec/libreswan/src/local_action_update_crl.py",
        "auto-ipsec/racoon/generate.py",
        "auto-ipsec/racoon/src/local_action_deletesa.py",
        "auto-ipsec/racoon/src/local_action_update_crl.py",
        "demo/agent_monitor/tenant_agent_monitor.py",
        "docker/Dockerfile-tpm12",
        "docker/Dockerfile-tpm20",
        "installer.sh",
        "keylime.conf",
        "keylime/agent_installer.spec",
        "keylime/agent_installer_2.spec",
        "keylime/benchmark/utility_average_logged_deltas.py",
        "keylime/benchmark/utility_make_1_second_interval_average_list.py",
        "keylime/benchmark/utility_smoothed_ts.py",
        "keylime/ca_impl_cfssl.py",
        "keylime/ca_impl_openssl.py",
        "keylime/ca_util.py",
        "keylime/cloud_agent.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/cmd_exec.py",
        "keylime/cn_installer.spec",
        "keylime/cn_installer_2.spec",
        "keylime/common.py",
        "keylime/crypto.py",
        "keylime/crypto2.py",
        "keylime/dev-clean.sh",
        "keylime/httpclient_requests.py",
        "keylime/ima.py",
        "keylime/ima_emulator_adapter.py",
        "keylime/keylime_logging.py",
        "keylime/keylime_sqlite.py",
        "keylime/make_agent_bundle.sh",
        "keylime/make_agent_bundle_tarball.sh",
        "keylime/openstack.py",
        "keylime/provider_platform_init.py",
        "keylime/provider_registrar.py",
        "keylime/provider_vtpm_add.py",
        "keylime/registrar.py",
        "keylime/registrar_client.py",
        "keylime/registrar_common.py",
        "keylime/revocation_actions/print_metadata.py",
        "keylime/revocation_actions/update_crl.py",
        "keylime/revocation_notifier.py",
        "keylime/secure_mount.py",
        "keylime/serve_uuid.py",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py",
        "keylime/tornado_requests.py",
        "keylime/tpm1.py",
        "keylime/tpm2.py",
        "keylime/tpm_abstract.py",
        "keylime/tpm_ek_ca.py",
        "keylime/tpm_obj.py",
        "keylime/user_data_encrypt.py",
        "keylime/vtpm_manager.py",
        "scripts/script_check_quote.py",
        "scripts/script_check_quote_raw.py",
        "scripts/script_create_quote.py",
        "scripts/script_old_quote.py",
        "scripts/script_vtpm_register.py",
        "scripts/script_vtpm_register.sh",
        "setup.py",
        "test/oldtest.py",
        "test/run_tests.sh",
        "test/test-requirements.txt",
        "test/test_ca_impl_openssl.py",
        "test/test_crypto.py",
        "test/test_kl_sqlite.py",
        "test/test_restful.py"
      ],
      "insertions": 3526,
      "deletions": 3095,
      "original_hash": "b39d2824ffe0768daec2161e328a04d80e569108",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "03263f154b0ddb40becdc3fc138418e5f2780cd7",
      "author": "Michael Peters",
      "author_email": "mpeters@redhat.com",
      "committed_date": "2020-09-16T10:19:41-04:00",
      "message": "Allow keylime to use larger whitelists\n\nBefore the limit was 100MB set by tornado, but now we're explicitly\nsetting and controlling it ourselves and making it configurable in\nkeylime.conf\n\nFixes issue #337",
      "files_changed": [
        "keylime.conf",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/httpclient_requests.py"
      ],
      "insertions": 25,
      "deletions": 4,
      "original_hash": "03263f154b0ddb40becdc3fc138418e5f2780cd7",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "3580bef8af074d8249f06d666a64ad982004702a",
      "author": "Thore Sommer",
      "author_email": "mail@thson.de",
      "committed_date": "2022-01-27T11:09:26-05:00",
      "message": "verifier: use \"supported_version\" for agent connections\n\nSigned-off-by: Thore Sommer <mail@thson.de>",
      "files_changed": [
        "keylime/cloud_verifier_tornado.py"
      ],
      "insertions": 12,
      "deletions": 8,
      "original_hash": "3580bef8af074d8249f06d666a64ad982004702a",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "4d8d8cd9acc8bc929af8bef0d4fca7b8a47b8d24",
      "author": "Luke Hinds",
      "author_email": "lhinds@redhat.com",
      "committed_date": "2020-03-31T09:35:57+01:00",
      "message": "SQLAlchemy port\n\nThis PR migrates Keylime from using raw sql statements tied to\nsqlite to an ORM model, allowing easier relational mapping and\na means to use more databases such as postgres / mariadb\n\nThis change is required for the early implementation of a multi\ntenancy based system.\n\nResolves: #130",
      "files_changed": [
        "docker/Dockerfile-tpm12",
        "docker/Dockerfile-tpm20",
        "installer.sh",
        "keylime.conf",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/ima.py",
        "keylime/keylime_database.py",
        "keylime/keylime_sqlite.py",
        "keylime/registrar.py",
        "keylime/registrar_common.py",
        "keylime/registrar_db.py",
        "keylime/tenant.py",
        "keylime/tpm1.py",
        "keylime/tpm2.py",
        "keylime/tpm_abstract.py",
        "keylime/verifier_db.py",
        "setup.py",
        "test/test_kl_sqlite.py",
        "test/test_registrar_db.py",
        "test/test_restful.py",
        "test/test_verifier_db.py"
      ],
      "insertions": 1158,
      "deletions": 857,
      "original_hash": "4d8d8cd9acc8bc929af8bef0d4fca7b8a47b8d24",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "112f82e2026ab8918b6f924af781ef29e3fb699d",
      "author": "Thore Sommer",
      "author_email": "mail@thson.de",
      "committed_date": "2022-01-27T11:09:26-05:00",
      "message": "tenant, verifier: allow manual configuration of agent mTLS\n\nSigned-off-by: Thore Sommer <mail@thson.de>",
      "files_changed": [
        "keylime.conf",
        "keylime/cloud_verifier_tornado.py",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py",
        "test/test_restful.py"
      ],
      "insertions": 44,
      "deletions": 12,
      "original_hash": "112f82e2026ab8918b6f924af781ef29e3fb699d",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "387e320dc22c89f4f47c68cb37eb9eec2137f34b",
      "author": "Alberto Planas",
      "author_email": "aplanas@suse.com",
      "committed_date": "2022-01-27T11:09:26-05:00",
      "message": "Validate user ID in all public interfaces\n\nThe user ID is read from the config file, or from some public REST API.\nWe should validate that is composed with valid set of chars.\n\nSigned-off-by: Alberto Planas <aplanas@suse.com>",
      "files_changed": [
        "keylime/cloud_verifier_tornado.py",
        "keylime/keylime_agent.py",
        "keylime/registrar_common.py",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py"
      ],
      "insertions": 93,
      "deletions": 3,
      "original_hash": "387e320dc22c89f4f47c68cb37eb9eec2137f34b",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "348c7894dfbb82b32382462480dd841b99afd528",
      "author": "Nabil Schear",
      "author_email": "heliousc6@gmail.com",
      "committed_date": "2016-12-07T19:46:39-05:00",
      "message": "bug fixes and minor feature enhancements",
      "files_changed": [
        "README.md",
        "keylime.conf",
        "keylime/ca_impl_cfssl.py",
        "keylime/ca_impl_openssl.py",
        "keylime/ca_util.py",
        "keylime/cloud_node.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/common.py",
        "keylime/create_whitelist.sh",
        "keylime/dev-clean.sh",
        "keylime/ima.py",
        "keylime/registrar_common.py",
        "keylime/tenant.py",
        "keylime/tornado_requests.py",
        "keylime/tpm_initialize.py",
        "keylime/tpm_nvram.py",
        "keylime/tpm_quote.py",
        "scripts/ima/ascii_runtime_measurements",
        "scripts/ima/ascii_runtime_measurements_ima",
        "scripts/ima/exclude.txt",
        "scripts/ima/whitelist.txt"
      ],
      "insertions": 62709,
      "deletions": 340,
      "original_hash": "348c7894dfbb82b32382462480dd841b99afd528",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "45d936c7fd84898ccca6e8cd00766e9965d13826",
      "author": "Thore Sommer",
      "author_email": "mail@thson.de",
      "committed_date": "2022-02-15T15:11:39-05:00",
      "message": "verifier: wait for connections to be closed before stopping ioloop\n\nWe now first stop the server to not accept new incoming connections and\nthen wait for all existing connections to be closed.\n\nInstead of forking with tornado.process.fork_processes() we now use\nPython's multiprocessing. This allows us to easily attach signal handlers\nto the server processes. Note that we now do not restart a process if it\nexisted unexpectedly.\n\nSigned-off-by: Thore Sommer <mail@thson.de>",
      "files_changed": [
        "keylime/cloud_verifier_tornado.py"
      ],
      "insertions": 52,
      "deletions": 19,
      "original_hash": "45d936c7fd84898ccca6e8cd00766e9965d13826",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "adb01bece57174fec77d884dbc672b72d8e5eead",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.ibm.com",
      "committed_date": "2021-07-29T16:37:42-04:00",
      "message": "verifier: Persist the IMA attestation state after running the log verification\n\nPersist the IMA attestation state after running the IMA log verification\nalong with the boottime of the system the agent is running on. We store\nthe list of PCRs that the IMA log modified as well as the values of those\nPCRs. Currently only PCR 10 is supported.\n\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/agentstates.py",
        "keylime/cloud_verifier_tornado.py"
      ],
      "insertions": 31,
      "deletions": 0,
      "original_hash": "adb01bece57174fec77d884dbc672b72d8e5eead",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "27f669fa3f754fc3f0d928b8849695af9fced5cb",
      "author": "Nabil Schear",
      "author_email": "nabil@ll.mit.edu",
      "committed_date": "2016-10-19T09:55:44-04:00",
      "message": "initial commit from local github commit aa47c31 on oct 19 2016, #523",
      "files_changed": [
        "DESCRIPTION.md",
        "LICENSE",
        "README.md",
        "doc/tci-acm.pdf",
        "keylime.conf",
        "keylime/__init__.py",
        "keylime/_cLime.c",
        "keylime/benchmark/perf.sh",
        "keylime/benchmark/utility_average_logged_deltas.py",
        "keylime/benchmark/utility_cloud_verifier_performance_logging.README",
        "keylime/benchmark/utility_make_1_second_interval_average_list.py",
        "keylime/benchmark/utility_plot_time_series.py",
        "keylime/benchmark/utility_smoothed_ts.py",
        "keylime/ca_util.py",
        "keylime/cloud_node.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/common.py",
        "keylime/crypto.py",
        "keylime/crypto2.py",
        "keylime/dev-clean.sh",
        "keylime/ima.py",
        "keylime/openstack.py",
        "keylime/provider_platform_init.py",
        "keylime/provider_registrar.py",
        "keylime/provider_vtpm_add.py",
        "keylime/registrar.py",
        "keylime/registrar_client.py",
        "keylime/registrar_common.py",
        "keylime/secure_mount.py",
        "keylime/serve_uuid.py",
        "keylime/tenant.py",
        "keylime/test.py",
        "keylime/tornado_requests.py",
        "keylime/tpm_cexec.py",
        "keylime/tpm_ek_ca.py",
        "keylime/tpm_exec.py",
        "keylime/tpm_initialize.py",
        "keylime/tpm_nvram.py",
        "keylime/tpm_quote.py",
        "keylime/tpm_random.py",
        "keylime/user_data_encrypt.py",
        "keylime/vtpm_manager.py",
        "patches/tpm4720-patch.txt",
        "patches/xen-vtpmmgr-patch.txt",
        "scripts/gen_test_files.sh",
        "scripts/llsrc-vtpm-host0_pubek.bin",
        "scripts/llsrc-vtpm-host0_pubek.pem",
        "scripts/moc-new.bu.edu-pubek.pem",
        "scripts/moc01.bu.edu-pubek.pem",
        "scripts/test_check_quote.py",
        "scripts/test_check_quote_raw.py",
        "scripts/test_create_quote.py",
        "scripts/test_old_quote.py",
        "scripts/test_vtpm_register.sh",
        "setup.py"
      ],
      "insertions": 13529,
      "deletions": 45,
      "original_hash": "27f669fa3f754fc3f0d928b8849695af9fced5cb",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "1665badacf351d97ee35aebaa94ce4f56dee4fd3",
      "author": "Kaifeng Wang",
      "author_email": "kaifeng.w@gmail.com",
      "committed_date": "2020-11-25T10:40:54-05:00",
      "message": "Stop checking simplejson in code\n\nrequirements should be guaranteed by packaging, not code,\nunless we also handle alternatives.",
      "files_changed": [
        "keylime/ca_impl_cfssl.py",
        "keylime/ca_util.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/common.py",
        "keylime/keylime_agent.py",
        "keylime/registrar_client.py",
        "keylime/registrar_common.py",
        "keylime/revocation_notifier.py",
        "keylime/serve_uuid.py",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py",
        "keylime/vtpm_manager.py"
      ],
      "insertions": 25,
      "deletions": 68,
      "original_hash": "1665badacf351d97ee35aebaa94ce4f56dee4fd3",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "23c2ae3f9aa1ab22f9a2fec02fc5e888475c38b3",
      "author": "Kaifeng Wang",
      "author_email": "kaifeng.w@gmail.com",
      "committed_date": "2021-04-08T11:35:48-04:00",
      "message": "Create allowlist table and basic API support\n\nCreate an allowlist table and basic API support for allowlist management\n\nSigned-off-by: Kaifeng Wang <kaifeng.w@gmail.com>",
      "files_changed": [
        "keylime/cloud_verifier_tornado.py",
        "keylime/db/verifier_db.py",
        "keylime/migrations/versions/eb869a77abd1_create_allowlist_table.py",
        "keylime/tenant.py",
        "test/test_restful.py",
        "test/test_verifier_db.py"
      ],
      "insertions": 405,
      "deletions": 46,
      "original_hash": "23c2ae3f9aa1ab22f9a2fec02fc5e888475c38b3",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "48b5e0c06d603c0671ef4c78c7803a6a3fbe36cd",
      "author": "Kaifeng Wang",
      "author_email": "kaifeng.w@gmail.com",
      "committed_date": "2021-01-15T09:31:33+08:00",
      "message": "Auto restore agents in Get Quote state upon verifier start\n\nDuring verifier startup, restore agents in GET QUOTE state to\nSTART, and ensure a coroutine to process agents in START towards\nGET QUOTE.\n\nResolves: #393\nSigned-off-by: Kaifeng Wang <kaifeng.w@gmail.com>",
      "files_changed": [
        "keylime/cloud_verifier_tornado.py"
      ],
      "insertions": 20,
      "deletions": 6,
      "original_hash": "48b5e0c06d603c0671ef4c78c7803a6a3fbe36cd",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "3c8022c5761332d09aaa077a12c7698c6e877334",
      "author": "Thore Sommer",
      "author_email": "mail@thson.de",
      "committed_date": "2022-01-27T11:09:26-05:00",
      "message": "verifier: connect to the agent via mTLS\n\nSigned-off-by: Thore Sommer <mail@thson.de>",
      "files_changed": [
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/registrar_common.py",
        "keylime/web_util.py"
      ],
      "insertions": 34,
      "deletions": 18,
      "original_hash": "3c8022c5761332d09aaa077a12c7698c6e877334",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "df86fac8e27e41b0cd2f06da6457212e1e4097e9",
      "author": "Michael Peters",
      "author_email": "mpeters@redhat.com",
      "committed_date": "2022-03-02T10:41:34-05:00",
      "message": "Add defaults for ephemeral keys for agent records\n\nWe already do this for agent entries coming from POST requests, but\nnot always when we restart and repopulate from the DB.\n\nThis should fix issue #603\n\nSigned-off-by: Michael Peters <mpeters@redhat.com>",
      "files_changed": [
        "keylime/cloud_verifier_tornado.py"
      ],
      "insertions": 8,
      "deletions": 2,
      "original_hash": "df86fac8e27e41b0cd2f06da6457212e1e4097e9",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "f072bd7f0d458a4d09bcd19518d2b0231df43fc2",
      "author": "Kaifeng Wang",
      "author_email": "kaifeng.w@gmail.com",
      "committed_date": "2021-01-15T09:31:33+08:00",
      "message": "Move agents handling out of tornado request handler\n\nIt's not necessarily tight with request handler, by moving\nit to the outter scope, it is possible to re-trigger agent\nprocessing during verifier startup.\n\nRelates-to: #393\nSigned-off-by: Kaifeng Wang <kaifeng.w@gmail.com>",
      "files_changed": [
        "keylime/cloud_verifier_tornado.py"
      ],
      "insertions": 210,
      "deletions": 214,
      "original_hash": "f072bd7f0d458a4d09bcd19518d2b0231df43fc2",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "16ef62914156fa384e29e0683b76cc6f20800636",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.vnet.ibm.com",
      "committed_date": "2021-01-12T16:36:41+08:00",
      "message": "codestyle: Address issues related to W0223\n\nThis patch addresses the following issues detected by pylint:\n\n************ Module keylime.cloud_verifier_tornado\nkeylime/cloud_verifier_tornado.py:66:0: W0223: Method 'data_received' is abstract in class 'RequestHandler' but is not overridden (abstract-method)\nkeylime/cloud_verifier_tornado.py:92:0: W0223: Method 'data_received' is abstract in class 'RequestHandler' but is not overridden (abstract-method)\nkeylime/cloud_verifier_tornado.py:115:0: W0223: Method 'data_received' is abstract in class 'RequestHandler' but is not overridden (abstract-method)\n************* Module keylime.db.verifier_db\nkeylime/db/verifier_db.py:15:0: W0223: Method 'process_bind_param' is abstract in class 'TypeDecorator' but is not overridden (abstract-method)\nkeylime/db/verifier_db.py:15:0: W0223: Method 'process_literal_param' is abstract in class 'TypeDecorator' but is not overridden (abstract-method)\nkeylime/db/verifier_db.py:15:0: W0223: Method 'process_result_value' is abstract in class 'TypeDecorator' but is not overridden (abstract-method)\nkeylime/db/verifier_db.py:15:0: W0223: Method 'python_type' is abstract in class 'TypeEngine' but is not overridden (abstract-method)\n************* Module keylime.db.registrar_db\nkeylime/db/registrar_db.py:15:0: W0223: Method 'process_bind_param' is abstract in class 'TypeDecorator' but is not overridden (abstract-method)\nkeylime/db/registrar_db.py:15:0: W0223: Method 'process_literal_param' is abstract in class 'TypeDecorator' but is not overridden (abstract-method)\nkeylime/db/registrar_db.py:15:0: W0223: Method 'process_result_value' is abstract in class 'TypeDecorator' but is not overridden (abstract-method)\nkeylime/db/registrar_db.py:15:0: W0223: Method 'python_type' is abstract in class 'TypeEngine' but is not overridden (abstract-method)\n************* Module keylime.tenant_webapp\nkeylime/tenant_webapp.py:53:0: W0223: Method 'data_received' is abstract in class 'RequestHandler' but is not overridden (abstract-method)\nkeylime/tenant_webapp.py:67:0: W0223: Method 'data_received' is abstract in class 'RequestHandler' but is not overridden (abstract-method)\nkeylime/tenant_webapp.py:89:0: W0223: Method 'data_received' is abstract in class 'RequestHandler' but is not overridden (abstract-method)\nkeylime/tenant_webapp.py:292:0: W0223: Method 'data_received' is abstract in class 'RequestHandler' but is not overridden (abstract-method)\n\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/cloud_verifier_tornado.py",
        "keylime/db/registrar_db.py",
        "keylime/db/verifier_db.py",
        "keylime/tenant_webapp.py",
        "scripts/check_codestyle.sh"
      ],
      "insertions": 24,
      "deletions": 3,
      "original_hash": "16ef62914156fa384e29e0683b76cc6f20800636",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "bbb7706c88c425564ca5ad58f2d1c1922afd9dbd",
      "author": "Alberto Planas",
      "author_email": "aplanas@suse.com",
      "committed_date": "2022-01-27T12:17:27-05:00",
      "message": "Move umask calls only on entry points\n\n`umask` is set several times in the code, causing side effects.\n\nThis patch move out the calls to `umask` from the utility code into the\nentry points of the different services (agent, verifier, registrar and\nca).\n\nSigned-off-by: Alberto Planas <aplanas@suse.com>",
      "files_changed": [
        "keylime/ca_util.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/cmd/migrations_apply.py",
        "keylime/db/keylime_db.py",
        "keylime/fs_util.py",
        "keylime/keylime_agent.py",
        "keylime/registrar_common.py",
        "keylime/tpm/tpm_abstract.py",
        "test/test_fs_util.py"
      ],
      "insertions": 55,
      "deletions": 8,
      "original_hash": "bbb7706c88c425564ca5ad58f2d1c1922afd9dbd",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "9451127498147b3858cd93ef98240a4ef3a01478",
      "author": "Kaifeng Wang",
      "author_email": "3692884+kaifeng@users.noreply.github.com",
      "committed_date": "2020-05-18T12:30:52+01:00",
      "message": "Fixes requests to reactivate agent causes verifier exception (#311)\n\nThe agent passed to process_agent can be an orm obj (PUT)\r\nor a dict obj (POST), convert the agent to dict if it's not.\r\n\r\nResolves #310",
      "files_changed": [
        "keylime/cloud_verifier_tornado.py"
      ],
      "insertions": 20,
      "deletions": 0,
      "original_hash": "9451127498147b3858cd93ef98240a4ef3a01478",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "c5f0cd790b75be5eb0a9fa26e54800ce23c5e6ce",
      "author": "Thore Sommer",
      "author_email": "mail@thson.de",
      "committed_date": "2022-01-27T11:09:26-05:00",
      "message": "verifier, tenant: allow agents to not use mTLS\n\nThis is done in order to allow upgrading the server side first.\nThe next minor version will drop support for it.\n\nSigned-off-by: Thore Sommer <mail@thson.de>",
      "files_changed": [
        "keylime/cloud_verifier_tornado.py",
        "keylime/tenant.py"
      ],
      "insertions": 52,
      "deletions": 15,
      "original_hash": "c5f0cd790b75be5eb0a9fa26e54800ce23c5e6ce",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    },
    {
      "hash": "d632e2a3b510167ba997197f5232bc4456aa0394",
      "author": "Apoorve Mohan",
      "author_email": "apoorvemohan@gmail.com",
      "committed_date": "2021-05-26T11:25:39-04:00",
      "message": "multiple named verifiers sharing a single database\n\nSigned-off-by: Apoorve Mohan <apoorvemohan@gmail.com>",
      "files_changed": [
        "keylime.conf",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/db/verifier_db.py",
        "keylime/migrations/versions/b4d024197413_add_verfier_id_to_verifiermain_table.py",
        "keylime/tenant.py",
        "test/test_verifier_db.py"
      ],
      "insertions": 159,
      "deletions": 24,
      "original_hash": "d632e2a3b510167ba997197f5232bc4456aa0394",
      "malicious_files": [
        "keylime/cloud_verifier_tornado.py"
      ]
    }
  ]
}