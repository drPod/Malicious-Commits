{
  "keylime": [
    {
      "hash": "51215186f0f24f3fd13710c565b6188d7e4b88fd",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.vnet.ibm.com",
      "committed_date": "2020-12-22T09:28:45+08:00",
      "message": "codestyle: Address issues related to C0411\n\nThis patch addresses the following issues detected by pylint:\n\n************* Module keylime.tpm.tpm1\nkeylime/tpm/tpm1.py:10:0: C0411: standard import \"import os\" should be placed before \"import M2Crypto\" (wrong-import-order)\nkeylime/tpm/tpm1.py:11:0: C0411: standard import \"import re\" should be placed before \"import M2Crypto\" (wrong-import-order)\nkeylime/tpm/tpm1.py:12:0: C0411: standard import \"import sys\" should be placed before \"import M2Crypto\" (wrong-import-order)\nkeylime/tpm/tpm1.py:13:0: C0411: standard import \"import tempfile\" should be placed before \"import M2Crypto\" (wrong-import-order)\nkeylime/tpm/tpm1.py:14:0: C0411: standard import \"import threading\" should be placed before \"import M2Crypto\" (wrong-import-order)\nkeylime/tpm/tpm1.py:15:0: C0411: standard import \"import time\" should be placed before \"import M2Crypto\" (wrong-import-order)\nkeylime/tpm/tpm1.py:17:0: C0411: standard import \"import zlib\" should be placed before \"import M2Crypto\" (wrong-import-order)\nkeylime/tpm/tpm1.py:18:0: C0411: standard import \"import codecs\" should be placed before \"import M2Crypto\" (wrong-import-order)\n************* Module keylime.ca_util\nkeylime/ca_util.py:23:0: C0411: standard import \"import sys\" should be placed before \"from M2Crypto import X509, EVP, BIO\" (wrong-import-order)\nkeylime/ca_util.py:24:0: C0411: standard import \"import os\" should be placed before \"from M2Crypto import X509, EVP, BIO\" (wrong-import-order)\nkeylime/ca_util.py:25:0: C0411: standard import \"import base64\" should be placed before \"from M2Crypto import X509, EVP, BIO\" (wrong-import-order)\nkeylime/ca_util.py:26:0: C0411: standard import \"import argparse\" should be placed before \"from M2Crypto import X509, EVP, BIO\" (wrong-import-order)\nkeylime/ca_util.py:27:0: C0411: standard import \"import datetime\" should be placed before \"from M2Crypto import X509, EVP, BIO\" (wrong-import-order)\nkeylime/ca_util.py:28:0: C0411: standard import \"import getpass\" should be placed before \"from M2Crypto import X509, EVP, BIO\" (wrong-import-order)\nkeylime/ca_util.py:29:0: C0411: standard import \"import glob\" should be placed before \"from M2Crypto import X509, EVP, BIO\" (wrong-import-order)\nkeylime/ca_util.py:30:0: C0411: standard import \"import zipfile\" should be placed before \"from M2Crypto import X509, EVP, BIO\" (wrong-import-order)\nkeylime/ca_util.py:31:0: C0411: standard import \"import io\" should be placed before \"from M2Crypto import X509, EVP, BIO\" (wrong-import-order)\nkeylime/ca_util.py:32:0: C0411: standard import \"import socket\" should be placed before \"from M2Crypto import X509, EVP, BIO\" (wrong-import-order)\nkeylime/ca_util.py:33:0: C0411: standard import \"import threading\" should be placed before \"from M2Crypto import X509, EVP, BIO\" (wrong-import-order)\nkeylime/ca_util.py:34:0: C0411: standard import \"from http.server import HTTPServer, BaseHTTPRequestHandler\" should be placed before \"from M2Crypto import X509, EVP, BIO\" (wrong-import-order)\nkeylime/ca_util.py:35:0: C0411: standard import \"from socketserver import ThreadingMixIn\" should be placed before \"from M2Crypto import X509, EVP, BIO\" (wrong-import-order)\nkeylime/ca_util.py:36:0: C0411: standard import \"import time\" should be placed before \"from M2Crypto import X509, EVP, BIO\" (wrong-import-order)\n************* Module keylime.migrations.versions.8a44a4364f5a_initial_database_migration\nkeylime/migrations/versions/8a44a4364f5a_initial_database_migration.py:11:0: C0411: standard import \"import sys\" should be placed before \"from alembic import op\" (wrong-import-order)\n************* Module keylime.config\nkeylime/config.py:12:0: C0411: standard import \"from http.server import BaseHTTPRequestHandler\" should be placed before \"import tornado.web\" (wrong-import-order)\nkeylime/config.py:13:0: C0411: standard import \"import http.client\" should be placed before \"import tornado.web\" (wrong-import-order)\n************* Module keylime.cmd.migrations_apply\nkeylime/cmd/migrations_apply.py:9:0: C0411: standard import \"import os\" should be placed before \"import alembic.config\" (wrong-import-order)\n************* Module keylime.ca_impl_cfssl\nkeylime/ca_impl_cfssl.py:12:0: C0411: standard import \"import shutil\" should be placed before \"import requests\" (wrong-import-order)\nkeylime/ca_impl_cfssl.py:13:0: C0411: standard import \"import sys\" should be placed before \"import requests\" (wrong-import-order)\nkeylime/ca_impl_cfssl.py:20:0: C0411: third party import \"from M2Crypto import EVP, X509\" should be placed before \"from keylime import config\" (wrong-import-order)\n************* Module utility_plot_time_series\nkeylime/benchmark/utility_plot_time_series.py:9:0: C0411: standard import \"import argparse\" should be placed before \"import pylab\" (wrong-import-order)\nkeylime/benchmark/utility_plot_time_series.py:10:0: C0411: standard import \"import sys\" should be placed before \"import pylab\" (wrong-import-order)\n************* Module test.test_ca_impl_openssl\ntest/test_ca_impl_openssl.py:8:0: C0411: standard import \"import unittest\" should be placed before \"from keylime import ca_impl_openssl\" (wrong-import-order)\ntest/test_ca_impl_openssl.py:9:0: C0411: standard import \"import sys\" should be placed before \"from keylime import ca_impl_openssl\" (wrong-import-order)\ntest/test_ca_impl_openssl.py:10:0: C0411: standard import \"from pathlib import Path\" should be placed before \"from keylime import ca_impl_openssl\" (wrong-import-order)\n************* Module test.test_restful\ntest/test_restful.py:32:0: C0411: standard import \"import sys\" should be placed before \"import dbus\" (wrong-import-order)\ntest/test_restful.py:33:0: C0411: standard import \"import signal\" should be placed before \"import dbus\" (wrong-import-order)\ntest/test_restful.py:34:0: C0411: standard import \"import unittest\" should be placed before \"import dbus\" (wrong-import-order)\ntest/test_restful.py:35:0: C0411: standard import \"import subprocess\" should be placed before \"import dbus\" (wrong-import-order)\ntest/test_restful.py:36:0: C0411: standard import \"import time\" should be placed before \"import dbus\" (wrong-import-order)\ntest/test_restful.py:37:0: C0411: standard import \"import os\" should be placed before \"import dbus\" (wrong-import-order)\ntest/test_restful.py:38:0: C0411: standard import \"import base64\" should be placed before \"import dbus\" (wrong-import-order)\ntest/test_restful.py:39:0: C0411: standard import \"import threading\" should be placed before \"import dbus\" (wrong-import-order)\ntest/test_restful.py:40:0: C0411: standard import \"import shutil\" should be placed before \"import dbus\" (wrong-import-order)\ntest/test_restful.py:41:0: C0411: standard import \"import errno\" should be placed before \"import dbus\" (wrong-import-order)\ntest/test_restful.py:42:0: C0411: standard import \"import hashlib\" should be placed before \"import dbus\" (wrong-import-order)\ntest/test_restful.py:43:0: C0411: standard import \"from pathlib import Path\" should be placed before \"import dbus\" (wrong-import-order)\n************* Module test.test_verifier_db\ntest/test_verifier_db.py:9:0: C0411: third party import \"from sqlalchemy import create_engine\" should be placed before \"from keylime.db.verifier_db import VerfierMain\" (wrong-import-order)\n************* Module test.test_registrar_db\ntest/test_registrar_db.py:9:0: C0411: third party import \"from sqlalchemy import create_engine\" should be placed before \"from keylime.db.registrar_db import RegistrarMain\" (wrong-import-order)\n\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/benchmark/utility_plot_time_series.py",
        "keylime/ca_impl_cfssl.py",
        "keylime/ca_util.py",
        "keylime/cmd/migrations_apply.py",
        "keylime/config.py",
        "keylime/migrations/versions/8a44a4364f5a_initial_database_migration.py",
        "keylime/tpm/tpm1.py",
        "scripts/check_codestyle.sh",
        "test/test_ca_impl_openssl.py",
        "test/test_registrar_db.py",
        "test/test_restful.py",
        "test/test_verifier_db.py"
      ],
      "insertions": 25,
      "deletions": 15,
      "original_hash": "51215186f0f24f3fd13710c565b6188d7e4b88fd",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "352aab6843e16f766c17140e4958a20e01f5a6bb",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.vnet.ibm.com",
      "committed_date": "2020-11-23T16:11:28-05:00",
      "message": "ima: Skip empty lines earlier\n\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/ima.py"
      ],
      "insertions": 2,
      "deletions": 2,
      "original_hash": "352aab6843e16f766c17140e4958a20e01f5a6bb",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "bec9fe3ed40719fa40ede21a79767cf32afc9114",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.ibm.com",
      "committed_date": "2021-08-05T10:34:54-04:00",
      "message": "ima: Implement ima-buf validator and validate keys on keyrings (#725)\n\nImplement the ima-buf validator and check whether the data part of the\r\nima-buf log entry is a keyring to check it against a keyring entry. Use the\r\n'keyrings' selector for selecting the 'keyrings' map in the allowlist when\r\nchecking the keyring name using the ima-ng validator.\r\n\r\nExtend the JSON alist with a map for 'keyrings' and approved hashes for\r\nkeys to be loaded into keyrings. Bump up the version of the supported\r\nallowlist format.\r\n\r\nIf an allowlist has a version, accept any version <= current version\r\nassuming that we provide backwards compatibility.\r\n\r\nConvert entries from the (legacy) flat allowlist starting with %keyring:,\r\nsuch as %keyring:.ima, to get entries in the JSON allow list. In this\r\nexample the .ima keyring would get a hash entry.\r\n\r\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/ima.py",
        "test/data/gpg-sig.pub",
        "test/data/ima-allowlist-short.sig",
        "test/data/ima-allowlist-short.txt",
        "test/test_ima_verification.py"
      ],
      "insertions": 112,
      "deletions": 58,
      "original_hash": "bec9fe3ed40719fa40ede21a79767cf32afc9114",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "d1b51044d872e062eaba73c29fd2cb1de31ac8e7",
      "author": "Marcio Silva",
      "author_email": "marcios@us.ibm.com",
      "committed_date": "2021-03-17T11:05:49-04:00",
      "message": "New and improved code to fix issue #582\n\nThe two main characteristics requested by @mpeters are present:\n\n1) `tpm_bootlog_enrich` is now conditionally loaded (only if\nverifier and only if measured boot is activated, via tenant).\nAgents and Registrar will work now without even bothering about it.\n\n2) A proper error message is presented in case the shared library,\nwhich is now a parameter in `config.py`, is not found\n\nSigned-off-by: Marcio Silva <marcios@us.ibm.com>",
      "files_changed": [
        "keylime/config.py",
        "keylime/tpm/tpm_abstract.py",
        "keylime/tpm/tpm_main.py",
        "keylime/tpm_bootlog_enrich.py"
      ],
      "insertions": 18,
      "deletions": 5,
      "original_hash": "d1b51044d872e062eaba73c29fd2cb1de31ac8e7",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "5bcd88dd566865086885ac3b3eec88b35ea06bbf",
      "author": "nabil",
      "author_email": "nabil@ll.mit.edu",
      "committed_date": "2017-07-20T15:55:02-04:00",
      "message": "adding revocation notifier, tenant webapp, demos, ima stub.  Various bug fixes and other enhancements.",
      "files_changed": [
        "README.md",
        "demo/README.md",
        "demo/demo_setup.sh",
        "demo/ima-policy",
        "demo/keyfile.txt",
        "demo/mount.sh",
        "demo/node_monitor/README.md",
        "demo/node_monitor/mount.sh",
        "demo/node_monitor/tenant_node_monitor.py",
        "demo/node_monitor/tenant_node_monitor.sh",
        "demo/payload.enc",
        "demo/payload.txt",
        "demo/payload/index.html",
        "demo/payload/vault.jpg",
        "doc/keylime RESTful API.docx",
        "ima_stub_service/README.md",
        "ima_stub_service/installer.sh",
        "ima_stub_service/tpm_emulator.service",
        "ima_stub_service/tpm_with_ima.sh",
        "installer.sh",
        "keylime.conf",
        "keylime/.gitignore",
        "keylime/ca_impl_cfssl.py",
        "keylime/ca_impl_openssl.py",
        "keylime/ca_util.py",
        "keylime/cloud_node.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/cn_installer.spec",
        "keylime/common.py",
        "keylime/create_whitelist.sh",
        "keylime/crypto.py",
        "keylime/dev-clean.sh",
        "keylime/ima.py",
        "keylime/ima_emulator_adapter.py",
        "keylime/keylime_sqlite.py",
        "keylime/make_node_bundle_tarball.sh",
        "keylime/provider_platform_init.py",
        "keylime/provider_registrar.py",
        "keylime/provider_vtpm_add.py",
        "keylime/registrar.py",
        "keylime/registrar_client.py",
        "keylime/registrar_common.py",
        "keylime/revocation_actions/__init__.py",
        "keylime/revocation_actions/print_metadata.py",
        "keylime/revocation_actions/update_crl.py",
        "keylime/revocation_notifier.py",
        "keylime/secure_mount.py",
        "keylime/serve_uuid.py",
        "keylime/static/css/webapp.css",
        "keylime/static/icons/ICON-LICENSE",
        "keylime/static/icons/README.md",
        "keylime/static/icons/png/ban-2x.png",
        "keylime/static/icons/png/ban-3x.png",
        "keylime/static/icons/png/ban-4x.png",
        "keylime/static/icons/png/ban-6x.png",
        "keylime/static/icons/png/ban-8x.png",
        "keylime/static/icons/png/ban.png",
        "keylime/static/icons/png/bug-2x.png",
        "keylime/static/icons/png/bug-3x.png",
        "keylime/static/icons/png/bug-4x.png",
        "keylime/static/icons/png/bug-6x.png",
        "keylime/static/icons/png/bug-8x.png",
        "keylime/static/icons/png/bug.png",
        "keylime/static/icons/png/keylime.png",
        "keylime/static/icons/png/plus-2x.png",
        "keylime/static/icons/png/plus-3x.png",
        "keylime/static/icons/png/plus-4x.png",
        "keylime/static/icons/png/plus-6x.png",
        "keylime/static/icons/png/plus-8x.png",
        "keylime/static/icons/png/plus.png",
        "keylime/static/icons/png/trash-2x.png",
        "keylime/static/icons/png/trash-3x.png",
        "keylime/static/icons/png/trash-4x.png",
        "keylime/static/icons/png/trash-6x.png",
        "keylime/static/icons/png/trash-8x.png",
        "keylime/static/icons/png/trash.png",
        "keylime/static/js/webapp.js",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py",
        "keylime/tornado_requests.py",
        "keylime/tpm_initialize.py",
        "keylime/tpm_quote.py",
        "keylime/tpm_random.py",
        "patches/opensslconf-patch.txt",
        "patches/tpm4720-patch.txt",
        "patches/trustedgrub-patch.txt",
        "scripts/.gitignore",
        "setup.py"
      ],
      "insertions": 5161,
      "deletions": 5948,
      "original_hash": "5bcd88dd566865086885ac3b3eec88b35ea06bbf",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "e4ad1f3e5dd369c34ab04f4f64332adfbc9d22b1",
      "author": "Alberto Planas",
      "author_email": "aplanas@suse.com",
      "committed_date": "2022-01-13T08:58:41-05:00",
      "message": "config: support merge multiple config files\n\nCurrently Keylime read the config for all the services from the same\nfile, in /etc/keylime.conf.\n\nThis commit support the load of multiple configuration files, and\nmerge the contents together.  This will enable the separation of a\nsystem wide configuration file in /usr/etc/keylime.conf, and a admin\nowerwrite in /etc/keylime.conf.\n\nSigned-off-by: Alberto Planas <aplanas@suse.com>",
      "files_changed": [
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/config.py",
        "keylime/ima_ast.py",
        "keylime/keylime_logging.py",
        "keylime/revocation_notifier.py",
        "test/data/config/keylime-1.conf",
        "test/data/config/keylime-2.conf",
        "test/data/config/keylime-3.conf",
        "test/test_config.py"
      ],
      "insertions": 133,
      "deletions": 70,
      "original_hash": "e4ad1f3e5dd369c34ab04f4f64332adfbc9d22b1",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "34d7f24c50d82b88b3e72aeef6611d551b9466c2",
      "author": "Maurizio Drocco",
      "author_email": "maurizio.drocco@gmail.com",
      "committed_date": "2020-09-14T15:08:12+01:00",
      "message": "first tentative fix #341 (#343)\n\nFixes Inconsistency between IMA logs and PCR10\r\n\r\nResolves: #341",
      "files_changed": [
        "keylime/ima.py",
        "keylime/tpm/tpm_abstract.py"
      ],
      "insertions": 14,
      "deletions": 5,
      "original_hash": "34d7f24c50d82b88b3e72aeef6611d551b9466c2",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "94054588ea423db772d51a111ca4c5707b814fac",
      "author": "Luke Hinds",
      "author_email": "7058938+lukehinds@users.noreply.github.com",
      "committed_date": "2020-05-27T16:42:31+01:00",
      "message": "Move to using SPDX Licence Format (#315)\n\nMove to using SPDX Licence Format",
      "files_changed": [
        "auto-ipsec/libreswan/generate.py",
        "auto-ipsec/libreswan/src/local_action_crashsa.py",
        "auto-ipsec/libreswan/src/local_action_update_crl.py",
        "auto-ipsec/racoon/generate.py",
        "auto-ipsec/racoon/src/local_action_deletesa.py",
        "auto-ipsec/racoon/src/local_action_update_crl.py",
        "demo/agent_monitor/autorun.sh",
        "demo/agent_monitor/tenant_agent_monitor.py",
        "demo/agent_monitor/tenant_agent_monitor.sh",
        "demo/autorun.sh",
        "demo/demo_setup.sh",
        "ima_stub_service/installer.sh",
        "ima_stub_service/tpm_with_ima.sh",
        "installer.sh",
        "keylime/_cLime.c",
        "keylime/benchmark/perf.sh",
        "keylime/benchmark/utility_average_logged_deltas.py",
        "keylime/benchmark/utility_make_1_second_interval_average_list.py",
        "keylime/benchmark/utility_plot_time_series.py",
        "keylime/benchmark/utility_smoothed_ts.py",
        "keylime/ca_impl_cfssl.py",
        "keylime/ca_impl_openssl.py",
        "keylime/ca_util.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/cmd/agent.py",
        "keylime/cmd/ca.py",
        "keylime/cmd/registrar.py",
        "keylime/cmd/tenant.py",
        "keylime/cmd/user_data_encrypt.py",
        "keylime/cmd/verifier.py",
        "keylime/cmd/webapp.py",
        "keylime/cmd_exec.py",
        "keylime/common.py",
        "keylime/crypto.py",
        "keylime/cryptodome.py",
        "keylime/db/keylime_db.py",
        "keylime/db/registrar_db.py",
        "keylime/db/verifier_db.py",
        "keylime/dev-clean.sh",
        "keylime/httpclient_requests.py",
        "keylime/ima.py",
        "keylime/ima_emulator_adapter.py",
        "keylime/keylime_agent.py",
        "keylime/keylime_logging.py",
        "keylime/make_agent_bundle.sh",
        "keylime/make_agent_bundle_tarball.sh",
        "keylime/openstack.py",
        "keylime/provider_platform_init.py",
        "keylime/provider_registrar.py",
        "keylime/provider_vtpm_add.py",
        "keylime/registrar_client.py",
        "keylime/registrar_common.py",
        "keylime/revocation_actions/print_metadata.py",
        "keylime/revocation_actions/update_crl.py",
        "keylime/revocation_notifier.py",
        "keylime/secure_mount.py",
        "keylime/serve_uuid.py",
        "keylime/static/css/webapp.css",
        "keylime/static/js/webapp.js",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py",
        "keylime/tornado_requests.py",
        "keylime/tpm_ek_ca.py",
        "keylime/vtpm_manager.py",
        "scripts/create_whitelist.sh",
        "services/installer.sh",
        "setup.cfg",
        "setup.py",
        "test/oldtest.py",
        "test/run_tests.sh",
        "test/test_ca_impl_openssl.py",
        "test/test_crypto.py",
        "test/test_registrar_db.py",
        "test/test_restful.py",
        "test/test_verifier_db.py"
      ],
      "insertions": 502,
      "deletions": 1460,
      "original_hash": "94054588ea423db772d51a111ca4c5707b814fac",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "7ffb052d1c23071d2ea2f3c5ab504c6f7e19e5cc",
      "author": "Michael Peters",
      "author_email": "mpeters@redhat.com",
      "committed_date": "2021-07-28T09:36:21-04:00",
      "message": "Versioned APIs\n\nPer Enhancement #45\n\nSigned-off-by: Michael Peters <mpeters@redhat.com>",
      "files_changed": [
        "keylime/api_version.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/config.py",
        "keylime/keylime_agent.py",
        "keylime/registrar_client.py",
        "keylime/registrar_common.py",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py",
        "requirements.txt",
        "test/test_api_version.py",
        "test/test_restful.py"
      ],
      "insertions": 326,
      "deletions": 77,
      "original_hash": "7ffb052d1c23071d2ea2f3c5ab504c6f7e19e5cc",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "cc5efe3e64f71daab41dd54c676759db75499e80",
      "author": "Kaifeng Wang",
      "author_email": "kaifeng.w@gmail.com",
      "committed_date": "2020-12-10T10:41:33-05:00",
      "message": "Rename common to config\n\nSo that we will have a common directory to hold common codes,\nthe previous common is actually a mix with configurations, debug\nflags, helpers. We can further move those helpers into common module\nand let conf only handles configurations.\n\nAlso rename utils/ to common/",
      "files_changed": [
        "archive/script_check_quote.py",
        "archive/script_check_quote_raw.py",
        "archive/script_create_quote.py",
        "auto-ipsec/libreswan/src/local_action_crashsa.py",
        "auto-ipsec/libreswan/src/local_action_update_crl.py",
        "auto-ipsec/racoon/src/local_action_deletesa.py",
        "auto-ipsec/racoon/src/local_action_update_crl.py",
        "keylime/ca_impl_cfssl.py",
        "keylime/ca_impl_openssl.py",
        "keylime/ca_util.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/cmd/ima_emulator_adapter.py",
        "keylime/cmd/provider_platform_init.py",
        "keylime/cmd/provider_registrar.py",
        "keylime/cmd/provider_vtpm_add.py",
        "keylime/cmd/registrar.py",
        "keylime/cmd/verifier.py",
        "keylime/common.py",
        "keylime/common/__init__.py",
        "keylime/common/algorithms.py",
        "keylime/config.py",
        "keylime/db/keylime_db.py",
        "keylime/ima.py",
        "keylime/keylime_agent.py",
        "keylime/keylime_logging.py",
        "keylime/registrar_client.py",
        "keylime/registrar_common.py",
        "keylime/revocation_actions/print_metadata.py",
        "keylime/revocation_actions/update_crl.py",
        "keylime/revocation_notifier.py",
        "keylime/secure_mount.py",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py",
        "keylime/tpm/tpm1.py",
        "keylime/tpm/tpm2.py",
        "keylime/tpm/tpm_abstract.py",
        "keylime/tpm/tpm_obj.py",
        "keylime/tpm_ek_ca.py",
        "keylime/utils/__init__.py",
        "keylime/utils/algorithms.py",
        "keylime/vtpm_manager.py",
        "test/test_restful.py"
      ],
      "insertions": 811,
      "deletions": 827,
      "original_hash": "cc5efe3e64f71daab41dd54c676759db75499e80",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "05a14a18f62abfbfef759b2e826588f0ebe4ff9f",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.ibm.com",
      "committed_date": "2021-01-18T14:40:19-05:00",
      "message": "ima: Support signature verification without allowlist verification\n\nSupport signature verfication without requiring an allowlist verification.\nAvoid failure when trying to read an allowlist and none has been specified.\n\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/ima.py"
      ],
      "insertions": 4,
      "deletions": 0,
      "original_hash": "05a14a18f62abfbfef759b2e826588f0ebe4ff9f",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "39b0df79d03b9b5959e99496a132363efa588b4a",
      "author": "jetwhiz",
      "author_email": "charles.munson@ll.mit.edu",
      "committed_date": "2019-01-18T17:51:34-05:00",
      "message": "Add TPM 2.0 support to Keylime\n\nNote that this release relies on the following repositories:\n    TPM2 Software Stack\n        https://github.com/tpm2-software/tpm2-tss/\n    TPM2 Tools\n        https://github.com/mit-ll/tpm2-tools/\n    TPM2 Access Broker & Resource Management Daemon (optional)\n        https://github.com/tpm2-software/tpm2-abrmd\n    IBM TPM2 emulator v1119 (optional)\n        http://sourceforge.net/projects/ibmswtpm2/",
      "files_changed": [
        "README.md",
        "auto-ipsec/libreswan/src/local_action_crashsa.py",
        "auto-ipsec/racoon/src/local_action_deletesa.py",
        "demo/node_monitor/autorun.sh",
        "demo/node_monitor/tenant_node_monitor.py",
        "doc/hotcloud18.pdf",
        "doc/keylime RESTful API.docx",
        "ima_stub_service/tpm_with_ima.sh",
        "installer.sh",
        "keylime.conf",
        "keylime/ca_util.py",
        "keylime/cloud_node.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/cmd_exec.py",
        "keylime/cn_installer.spec",
        "keylime/cn_installer_2.spec",
        "keylime/common.py",
        "keylime/create_whitelist.sh",
        "keylime/ima_emulator_adapter.py",
        "keylime/keylime_sqlite.py",
        "keylime/make_node_bundle.sh",
        "keylime/make_node_bundle_tarball.sh",
        "keylime/registrar_client.py",
        "keylime/registrar_common.py",
        "keylime/secure_mount.py",
        "keylime/static/css/webapp.css",
        "keylime/static/js/webapp.js",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py",
        "keylime/tpm1.py",
        "keylime/tpm2.py",
        "keylime/tpm_abstract.py",
        "keylime/tpm_cexec.py",
        "keylime/tpm_ek_ca.py",
        "keylime/tpm_exec.py",
        "keylime/tpm_initialize.py",
        "keylime/tpm_nvram.py",
        "keylime/tpm_obj.py",
        "keylime/tpm_quote.py",
        "keylime/tpm_random.py",
        "keylime/vtpm_manager.py",
        "setup.py",
        "swtpm2_scripts/init_tpm_server",
        "swtpm2_scripts/tpm_serverd",
        "test-data/emulator-inputs.txt",
        "test-data/tpm-inputs.txt",
        "test-data/tpm1.2/emulator-inputs.txt",
        "test-data/tpm1.2/tpm-inputs.txt",
        "test-data/tpm1.2/vtpm-inputs.txt",
        "test-data/tpm2/emulator-inputs.txt",
        "test-data/tpm2/files/actcred.out",
        "test-data/tpm2/files/ak.name",
        "test-data/tpm2/files/ak.pub",
        "test-data/tpm2/files/akpub.pem",
        "test-data/tpm2/files/ek.pub",
        "test-data/tpm2/files/ekpub.pem",
        "test-data/tpm2/files/mkcred.out",
        "test-data/tpm2/files/nv.data",
        "test-data/tpm2/files/quote.out",
        "test-data/tpm2/files/quotepcr.out",
        "test-data/tpm2/files/quotesig.out",
        "test-data/tpm2/files/rand.out",
        "test-data/tpm2/files/secret.data",
        "test-data/vtpm-inputs.txt",
        "test/test_restful.py"
      ],
      "insertions": 8295,
      "deletions": 3482,
      "original_hash": "39b0df79d03b9b5959e99496a132363efa588b4a",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "b39d2824ffe0768daec2161e328a04d80e569108",
      "author": "Luke Hinds",
      "author_email": "lhinds@redhat.com",
      "committed_date": "2019-09-05T19:15:16+01:00",
      "message": "Python 3 Port\n\nPort from Python 2 to Python 3(.7). Numerous changes were made,\ntoo many to mention.\n\nThe list of full commits is retained below:\n\nFix tarball bundler scripts\nremove os.close\nfix ups for tpm2/tpm_abstract\nfix ups\nAsync support for tornado\nFurther updates\nAsync support for tornado, issues resolved\nCharlies IMA fixes\nFixes async performance issues and secure mount failure\nFutrher encoding fixes\nInclude register_client changes\nFix for commit screw up\nFixes Unexpected Provide V response error\nChanges moved to correct location\nFixes Unexpected Provide V response\nWorking encrypted payload\nRemove redundant async and fix unit tests\n--verify and payloads fixed\nAdd binary flag to open enc_path\nImplement CYaml Loader / Dumper\nImplement JSON again outside of crypto handling (its faster)\nImplement ozoder/logging-refactor\nFurther fixes to Keylime logging\nhttp.client exception handler added\nfix some codacy issues\nNabil fixes and other small changes\nPlaced import time back in\nFix for file write\nclean up erorr handling\npython3 updates\nfix raise to include exception\nwriting out the wrong key for ek.  fix bytes/str issue with key handle\nfixing up string/bytes\nlist wasn't working right\ncfssl implementation\nadding simplejson to setup.py.\n3.8 will maintain compat with ubuntu 16.04 and rhel/cent 7.  those are\nprobably the oldest distros we'll want.\nadding simple json.  helpful gopath message\nfedora 30 default to get proper go support\nWorking GUI\nAdded missing port values to keylime.conf\nclean up installer message\nstring encoding\nf-strings\navoid two ioloops\nnabil's favorite testing\ncare when openign files\nbytes conversion\nmove this log message into the costructor to avoid confusion\non tpm1 this would still appear in the log\nswitch cfssl to use requests\nunambiguous imports\npy3 encoding issues in revocation notifier\ntypo in import\navoid warning on error\nwhew that one was hard to fine, cfssl revoking now\nAdd retry / timeout handler and needed changes in tenant.py\nuse fstrings for http.client params\nremove last async call\nUpdated readme\nclean up installer\nFixes cloud_verifier_tornado KeyError issue\n\nFix tarball bundler scripts",
      "files_changed": [
        ".ci/test_wrapper.sh",
        "README.md",
        "auto-ipsec/libreswan/generate.py",
        "auto-ipsec/libreswan/src/local_action_crashsa.py",
        "auto-ipsec/libreswan/src/local_action_update_crl.py",
        "auto-ipsec/racoon/generate.py",
        "auto-ipsec/racoon/src/local_action_deletesa.py",
        "auto-ipsec/racoon/src/local_action_update_crl.py",
        "demo/agent_monitor/tenant_agent_monitor.py",
        "docker/Dockerfile-tpm12",
        "docker/Dockerfile-tpm20",
        "installer.sh",
        "keylime.conf",
        "keylime/agent_installer.spec",
        "keylime/agent_installer_2.spec",
        "keylime/benchmark/utility_average_logged_deltas.py",
        "keylime/benchmark/utility_make_1_second_interval_average_list.py",
        "keylime/benchmark/utility_smoothed_ts.py",
        "keylime/ca_impl_cfssl.py",
        "keylime/ca_impl_openssl.py",
        "keylime/ca_util.py",
        "keylime/cloud_agent.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/cmd_exec.py",
        "keylime/cn_installer.spec",
        "keylime/cn_installer_2.spec",
        "keylime/common.py",
        "keylime/crypto.py",
        "keylime/crypto2.py",
        "keylime/dev-clean.sh",
        "keylime/httpclient_requests.py",
        "keylime/ima.py",
        "keylime/ima_emulator_adapter.py",
        "keylime/keylime_logging.py",
        "keylime/keylime_sqlite.py",
        "keylime/make_agent_bundle.sh",
        "keylime/make_agent_bundle_tarball.sh",
        "keylime/openstack.py",
        "keylime/provider_platform_init.py",
        "keylime/provider_registrar.py",
        "keylime/provider_vtpm_add.py",
        "keylime/registrar.py",
        "keylime/registrar_client.py",
        "keylime/registrar_common.py",
        "keylime/revocation_actions/print_metadata.py",
        "keylime/revocation_actions/update_crl.py",
        "keylime/revocation_notifier.py",
        "keylime/secure_mount.py",
        "keylime/serve_uuid.py",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py",
        "keylime/tornado_requests.py",
        "keylime/tpm1.py",
        "keylime/tpm2.py",
        "keylime/tpm_abstract.py",
        "keylime/tpm_ek_ca.py",
        "keylime/tpm_obj.py",
        "keylime/user_data_encrypt.py",
        "keylime/vtpm_manager.py",
        "scripts/script_check_quote.py",
        "scripts/script_check_quote_raw.py",
        "scripts/script_create_quote.py",
        "scripts/script_old_quote.py",
        "scripts/script_vtpm_register.py",
        "scripts/script_vtpm_register.sh",
        "setup.py",
        "test/oldtest.py",
        "test/run_tests.sh",
        "test/test-requirements.txt",
        "test/test_ca_impl_openssl.py",
        "test/test_crypto.py",
        "test/test_kl_sqlite.py",
        "test/test_restful.py"
      ],
      "insertions": 3526,
      "deletions": 3095,
      "original_hash": "b39d2824ffe0768daec2161e328a04d80e569108",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "db01bd3141d6887c2b867be4c3c0bec2fd7dce12",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.vnet.ibm.com",
      "committed_date": "2021-01-18T14:40:19-05:00",
      "message": "ima: Add support for ima-sig template\n\nThis patch adds support for the ima-sig template but does not locally\nverify signatures.\n\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/ima.py"
      ],
      "insertions": 45,
      "deletions": 2,
      "original_hash": "db01bd3141d6887c2b867be4c3c0bec2fd7dce12",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "65c2b737129b5837f4a03660aeb1191ced275a57",
      "author": "Alberto Planas",
      "author_email": "aplanas@suse.com",
      "committed_date": "2022-01-27T11:09:26-05:00",
      "message": "validators: create validators module\n\nMove from the config module some validators, and create the validators\nmodule.  Add tests for them.\n\nSigned-off-by: Alberto Planas <aplanas@suse.com>",
      "files_changed": [
        "keylime/cloud_verifier_common.py",
        "keylime/common/validators.py",
        "keylime/config.py",
        "keylime/ima.py",
        "keylime/keylime_agent.py",
        "test/test_validators.py"
      ],
      "insertions": 127,
      "deletions": 44,
      "original_hash": "65c2b737129b5837f4a03660aeb1191ced275a57",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "cccb6f7b9ffdf9ccf5d2f26b857ca07111829fb2",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.ibm.com",
      "committed_date": "2021-07-29T16:37:42-04:00",
      "message": "ima: Reset the attestation if processing the measurement list fails\n\nCreate a wrapper around the existing process_measurement_list that\nintercepts the returned result so that we can reset the attestation\nstate for a client system that failed the IMA attestation.\n\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/ima.py"
      ],
      "insertions": 14,
      "deletions": 1,
      "original_hash": "cccb6f7b9ffdf9ccf5d2f26b857ca07111829fb2",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "13c49ba2ebdd0353108e0a55e8aa9a8dbd32eda8",
      "author": "Kaifeng Wang",
      "author_email": "3692884+kaifeng@users.noreply.github.com",
      "committed_date": "2020-04-30T11:02:16+01:00",
      "message": "Singletonize configuration reading (#292)\n\nSingletonize configuration reading\r\n\r\nMoves configuration loading into the common module and make\r\nthe config loaded a global instance.\r\n\r\nSticks to ConfigParser instead of mixed usage of ConfigParser and\r\nRawConfigParser.",
      "files_changed": [
        "auto-ipsec/libreswan/src/local_action_crashsa.py",
        "auto-ipsec/libreswan/src/local_action_update_crl.py",
        "auto-ipsec/racoon/src/local_action_deletesa.py",
        "auto-ipsec/racoon/src/local_action_update_crl.py",
        "keylime/ca_impl_cfssl.py",
        "keylime/ca_impl_openssl.py",
        "keylime/ca_util.py",
        "keylime/cloud_agent.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/common.py",
        "keylime/ima.py",
        "keylime/provider_platform_init.py",
        "keylime/provider_registrar.py",
        "keylime/provider_vtpm_add.py",
        "keylime/registrar.py",
        "keylime/registrar_common.py",
        "keylime/revocation_actions/print_metadata.py",
        "keylime/revocation_actions/update_crl.py",
        "keylime/revocation_notifier.py",
        "keylime/secure_mount.py",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py",
        "keylime/tpm1.py",
        "keylime/tpm2.py",
        "keylime/tpm_abstract.py",
        "keylime/tpm_ek_ca.py",
        "keylime/tpm_obj.py"
      ],
      "insertions": 59,
      "deletions": 111,
      "original_hash": "13c49ba2ebdd0353108e0a55e8aa9a8dbd32eda8",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "0052ac12dba7cefd55c47b0fcfcc61616b4d3fa2",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.ibm.com",
      "committed_date": "2021-08-02T14:41:39-04:00",
      "message": "ima: Return an empty allowlist rather than a plain empty list\n\nread_allowlist() returns a plain empty list if al_path is None or ''.\nHowever, we should return a dict following the new format since that is\nwhat is returned when the list was converted from a JSON string or\nconverted from the old flat file format.\n\nCreate an empty_allowlist serving as a template to return in case an empty\nlist is to be returned and to extend when converting from the old flat\nfile.\n\nAlso, the code was reading the contents of the file into alist but this\nalist was then never read from. Remove the unnecessary code and only\nleave the 'test' for availability of the file.\n\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/ima.py"
      ],
      "insertions": 14,
      "deletions": 13,
      "original_hash": "0052ac12dba7cefd55c47b0fcfcc61616b4d3fa2",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "4d8d8cd9acc8bc929af8bef0d4fca7b8a47b8d24",
      "author": "Luke Hinds",
      "author_email": "lhinds@redhat.com",
      "committed_date": "2020-03-31T09:35:57+01:00",
      "message": "SQLAlchemy port\n\nThis PR migrates Keylime from using raw sql statements tied to\nsqlite to an ORM model, allowing easier relational mapping and\na means to use more databases such as postgres / mariadb\n\nThis change is required for the early implementation of a multi\ntenancy based system.\n\nResolves: #130",
      "files_changed": [
        "docker/Dockerfile-tpm12",
        "docker/Dockerfile-tpm20",
        "installer.sh",
        "keylime.conf",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/ima.py",
        "keylime/keylime_database.py",
        "keylime/keylime_sqlite.py",
        "keylime/registrar.py",
        "keylime/registrar_common.py",
        "keylime/registrar_db.py",
        "keylime/tenant.py",
        "keylime/tpm1.py",
        "keylime/tpm2.py",
        "keylime/tpm_abstract.py",
        "keylime/verifier_db.py",
        "setup.py",
        "test/test_kl_sqlite.py",
        "test/test_registrar_db.py",
        "test/test_restful.py",
        "test/test_verifier_db.py"
      ],
      "insertions": 1158,
      "deletions": 857,
      "original_hash": "4d8d8cd9acc8bc929af8bef0d4fca7b8a47b8d24",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "0dd6641ec82ac2b4026808771ba04b6dc1f822d7",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.ibm.com",
      "committed_date": "2021-10-12T13:39:01-04:00",
      "message": "ima: Use seek() to get to the last known last entry\n\nUse seek() to get to the last known last entry in the IMA measurement\nlist. Track the size of the IMA measurement list two last known number\nof entries in a singleton class that helps us seek to the last entry\nand return the tail of the measurement list at the n-th entry as re-\nquested by the caller.\n\nWe have to remember the last two known number of entries and file sizes\nsince the validator may not get a quote containing the last entry but\nthat of the previous last entry and will on the next attestation request\nagain ask for the same entry.\n\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/ima.py"
      ],
      "insertions": 68,
      "deletions": 21,
      "original_hash": "0dd6641ec82ac2b4026808771ba04b6dc1f822d7",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "95ef0415f890b525ab277c37705aba9c22600dff",
      "author": "maugustosilva",
      "author_email": "maugusto.silva@gmail.com",
      "committed_date": "2021-07-26T14:38:24-04:00",
      "message": "Automatically calculates the boot_aggregate from the measured boot log. (#713)\n\n* Automatically calculates the boot_aggregate from the measured boot log.\r\n\r\nThis PR uses the tsseventextend tool (found on package tss2), which\r\nreads the binary measured boot log (sent from the `agent` to the\r\n`verifier`), and then uses it to calculate the boot_aggregate.\r\nThis is done by using the (also calculated) values for PCRs 0-7(9)\r\nalso from the measured boot log (the need for contemplate both\r\nPCRs 0-7 and 0-9 comes from the combination of older kernels and\r\nolder versions of grub).\r\n\r\nSigned-off-by: Marcio Silva <marcio.a.silva@ibm.com>",
      "files_changed": [
        "installer.sh",
        "keylime/ima.py",
        "keylime/tpm/tpm_abstract.py",
        "keylime/tpm/tpm_main.py"
      ],
      "insertions": 52,
      "deletions": 13,
      "original_hash": "95ef0415f890b525ab277c37705aba9c22600dff",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "1013166ebe075f3de296807776e1f5b38c92435f",
      "author": "Luke Hinds",
      "author_email": "7058938+lukehinds@users.noreply.github.com",
      "committed_date": "2020-07-16T16:46:02+01:00",
      "message": "Port License to Apache 2.0 (#329)\n\n* Port License to Apache 2.0\r\n\r\nAs part of the proposal to join the CNCF, this change replaces\r\nlicense instances of BSD-2-Clause to Apache-2.0\r\n\r\nResolves: #327",
      "files_changed": [
        "LICENSE",
        "README.md",
        "auto-ipsec/libreswan/generate.py",
        "auto-ipsec/libreswan/src/local_action_crashsa.py",
        "auto-ipsec/libreswan/src/local_action_update_crl.py",
        "auto-ipsec/racoon/generate.py",
        "auto-ipsec/racoon/src/local_action_deletesa.py",
        "auto-ipsec/racoon/src/local_action_update_crl.py",
        "demo/agent_monitor/autorun.sh",
        "demo/agent_monitor/tenant_agent_monitor.py",
        "demo/agent_monitor/tenant_agent_monitor.sh",
        "demo/autorun.sh",
        "demo/demo_setup.sh",
        "ima_stub_service/installer.sh",
        "ima_stub_service/tpm_with_ima.sh",
        "installer.sh",
        "keylime/_cLime.c",
        "keylime/benchmark/perf.sh",
        "keylime/benchmark/utility_average_logged_deltas.py",
        "keylime/benchmark/utility_make_1_second_interval_average_list.py",
        "keylime/benchmark/utility_plot_time_series.py",
        "keylime/benchmark/utility_smoothed_ts.py",
        "keylime/ca_impl_cfssl.py",
        "keylime/ca_impl_openssl.py",
        "keylime/ca_util.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/cmd/agent.py",
        "keylime/cmd/ca.py",
        "keylime/cmd/ima_emulator_adapter.py",
        "keylime/cmd/provider_platform_init.py",
        "keylime/cmd/provider_registrar.py",
        "keylime/cmd/provider_vtpm_add.py",
        "keylime/cmd/registrar.py",
        "keylime/cmd/tenant.py",
        "keylime/cmd/user_data_encrypt.py",
        "keylime/cmd/verifier.py",
        "keylime/cmd/webapp.py",
        "keylime/cmd_exec.py",
        "keylime/common.py",
        "keylime/crypto.py",
        "keylime/cryptodome.py",
        "keylime/db/keylime_db.py",
        "keylime/db/registrar_db.py",
        "keylime/db/verifier_db.py",
        "keylime/dev-clean.sh",
        "keylime/httpclient_requests.py",
        "keylime/ima.py",
        "keylime/keylime_agent.py",
        "keylime/keylime_logging.py",
        "keylime/make_agent_bundle.sh",
        "keylime/make_agent_bundle_tarball.sh",
        "keylime/openstack.py",
        "keylime/registrar_client.py",
        "keylime/registrar_common.py",
        "keylime/revocation_actions/print_metadata.py",
        "keylime/revocation_actions/update_crl.py",
        "keylime/revocation_notifier.py",
        "keylime/secure_mount.py",
        "keylime/serve_uuid.py",
        "keylime/static/css/webapp.css",
        "keylime/static/js/webapp.js",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py",
        "keylime/tornado_requests.py",
        "keylime/tpm_ek_ca.py",
        "keylime/vtpm_manager.py",
        "scripts/create_whitelist.sh",
        "services/installer.sh",
        "setup.cfg",
        "setup.py",
        "test/oldtest.py",
        "test/run_tests.sh",
        "test/test_ca_impl_openssl.py",
        "test/test_crypto.py",
        "test/test_registrar_db.py",
        "test/test_restful.py",
        "test/test_verifier_db.py"
      ],
      "insertions": 2155,
      "deletions": 1487,
      "original_hash": "1013166ebe075f3de296807776e1f5b38c92435f",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "348c7894dfbb82b32382462480dd841b99afd528",
      "author": "Nabil Schear",
      "author_email": "heliousc6@gmail.com",
      "committed_date": "2016-12-07T19:46:39-05:00",
      "message": "bug fixes and minor feature enhancements",
      "files_changed": [
        "README.md",
        "keylime.conf",
        "keylime/ca_impl_cfssl.py",
        "keylime/ca_impl_openssl.py",
        "keylime/ca_util.py",
        "keylime/cloud_node.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/common.py",
        "keylime/create_whitelist.sh",
        "keylime/dev-clean.sh",
        "keylime/ima.py",
        "keylime/registrar_common.py",
        "keylime/tenant.py",
        "keylime/tornado_requests.py",
        "keylime/tpm_initialize.py",
        "keylime/tpm_nvram.py",
        "keylime/tpm_quote.py",
        "scripts/ima/ascii_runtime_measurements",
        "scripts/ima/ascii_runtime_measurements_ima",
        "scripts/ima/exclude.txt",
        "scripts/ima/whitelist.txt"
      ],
      "insertions": 62709,
      "deletions": 340,
      "original_hash": "348c7894dfbb82b32382462480dd841b99afd528",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "c93fff3953fcaa11010fe5bc212e50a472b00215",
      "author": "Marcio Silva",
      "author_email": "marcios@us.ibm.com",
      "committed_date": "2021-02-02T12:02:12-05:00",
      "message": "First PR (of a total of 3) to address #491\n\n* The `agent` will now retrieve TPM 2.0 preboot event log and will ship\nit to the `verifier`. The latter will do nothing with it (just receives\nand ignores it)\n* Adds a new `keylime_tenant` CLI option, `--mb_refstate` (that was a\nrequest from @mpeters) to signal the need for the agent to collect the\nthe event log. At this point, `keylime_tenant` do not actually process\nthis option (it shall be processed in a manner similar to IMA in a\nfuture PR), it is simply used to signal the agent that \"tpm2 preboot\nevent log\" should be read.\n* Hard-coded PCRs [0-9], 14 and path\n/sys/kernel/security/tpm0/binary_bios_measurements for the event log\n* The `verifier` will output a debug logging message stating that it\nreceived the \"tpm2 event log\", and will send it down to the `check_pcrs`\nmethod, but there is no actual processing there (it will be done in\nsubsequent PR)\n\nSigned-off-by: Marcio Silva <marcios@us.ibm.com>",
      "files_changed": [
        "keylime/cloud_verifier_common.py",
        "keylime/config.py",
        "keylime/keylime_agent.py",
        "keylime/tenant.py",
        "keylime/tpm/tpm1.py",
        "keylime/tpm/tpm2.py",
        "keylime/tpm/tpm_abstract.py"
      ],
      "insertions": 86,
      "deletions": 9,
      "original_hash": "c93fff3953fcaa11010fe5bc212e50a472b00215",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "b7cfc08a92aeff35f7c9bb6f048e840713749e61",
      "author": "Kaifeng Wang",
      "author_email": "kaifeng.w@gmail.com",
      "committed_date": "2020-10-30T11:11:22-04:00",
      "message": "Remove the DEVELOP_IN_ECLIPSE support\n\nThe support to develop in eclipse is no longer supported\nand removed.\n\nResolves #383",
      "files_changed": [
        "keylime/ca_util.py",
        "keylime/cmd/provider_platform_init.py",
        "keylime/cmd/provider_vtpm_add.py",
        "keylime/common.py",
        "keylime/keylime_agent.py",
        "keylime/tenant.py"
      ],
      "insertions": 11,
      "deletions": 95,
      "original_hash": "b7cfc08a92aeff35f7c9bb6f048e840713749e61",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "3a5c8c8f6dd17e68e02b68ad961ed71b71267e5d",
      "author": "Michael Peters",
      "author_email": "mpeters@redhat.com",
      "committed_date": "2021-03-17T11:52:56-04:00",
      "message": "Allowlist verification - Enhancement #16\n\n* Add support for new JSON allowlist spec\n  If the first non-whitespace character is a \"{\" then we treat it as\n  JSON. Else we convert the old plain text format into the same structured\n  data before passing it along\n* Allow checksum support for the allowlist\n* Allow GPG signature verification for the allowlist\n* Allow pulling the allowlist and the signature from a URL\n\nSigned-off-by: Michael Peters <mpeters@redhat.com>",
      "files_changed": [
        "keylime/ima.py",
        "keylime/tenant.py",
        "requirements.txt",
        "test/data/gpg-sig.pub",
        "test/data/ima-allowlist-bad.sig",
        "test/data/ima-allowlist-short.sig",
        "test/data/ima-allowlist-short.txt",
        "test/test_ima_verification.py"
      ],
      "insertions": 319,
      "deletions": 43,
      "original_hash": "3a5c8c8f6dd17e68e02b68ad961ed71b71267e5d",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "be4d04b0c3a1e752b0f57ad8977436b91a4d57de",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.ibm.com",
      "committed_date": "2021-10-11T14:05:15-04:00",
      "message": "ima: Extend JSON allowlist with 'ima' entry and 'ignored_keyrings'\n\nExtend the JSON formatted allowlist with an 'ima' entry holding\na map of configuration parameters, of which 'ignored_keyrings' is\nthe only one supported right now.\n\nImplement update_allowlist to update an older version of an allowlist\nto the latest version filling in default values for missing fields.\n\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/ima.py",
        "test/test_ima_verification.py"
      ],
      "insertions": 31,
      "deletions": 10,
      "original_hash": "be4d04b0c3a1e752b0f57ad8977436b91a4d57de",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "124b8c4db03cca071092a076947907801e43e00f",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.ibm.com",
      "committed_date": "2021-07-29T16:37:42-04:00",
      "message": "agent: Move IMA measurement list reading function to ima.py\n\nMove reading the IMA measurement list to ima.py and add support for reading\nthe measurement list from a certain entry number. Read from entry 0 for now.\n\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/ima.py",
        "keylime/keylime_agent.py"
      ],
      "insertions": 47,
      "deletions": 5,
      "original_hash": "124b8c4db03cca071092a076947907801e43e00f",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "27f669fa3f754fc3f0d928b8849695af9fced5cb",
      "author": "Nabil Schear",
      "author_email": "nabil@ll.mit.edu",
      "committed_date": "2016-10-19T09:55:44-04:00",
      "message": "initial commit from local github commit aa47c31 on oct 19 2016, #523",
      "files_changed": [
        "DESCRIPTION.md",
        "LICENSE",
        "README.md",
        "doc/tci-acm.pdf",
        "keylime.conf",
        "keylime/__init__.py",
        "keylime/_cLime.c",
        "keylime/benchmark/perf.sh",
        "keylime/benchmark/utility_average_logged_deltas.py",
        "keylime/benchmark/utility_cloud_verifier_performance_logging.README",
        "keylime/benchmark/utility_make_1_second_interval_average_list.py",
        "keylime/benchmark/utility_plot_time_series.py",
        "keylime/benchmark/utility_smoothed_ts.py",
        "keylime/ca_util.py",
        "keylime/cloud_node.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/common.py",
        "keylime/crypto.py",
        "keylime/crypto2.py",
        "keylime/dev-clean.sh",
        "keylime/ima.py",
        "keylime/openstack.py",
        "keylime/provider_platform_init.py",
        "keylime/provider_registrar.py",
        "keylime/provider_vtpm_add.py",
        "keylime/registrar.py",
        "keylime/registrar_client.py",
        "keylime/registrar_common.py",
        "keylime/secure_mount.py",
        "keylime/serve_uuid.py",
        "keylime/tenant.py",
        "keylime/test.py",
        "keylime/tornado_requests.py",
        "keylime/tpm_cexec.py",
        "keylime/tpm_ek_ca.py",
        "keylime/tpm_exec.py",
        "keylime/tpm_initialize.py",
        "keylime/tpm_nvram.py",
        "keylime/tpm_quote.py",
        "keylime/tpm_random.py",
        "keylime/user_data_encrypt.py",
        "keylime/vtpm_manager.py",
        "patches/tpm4720-patch.txt",
        "patches/xen-vtpmmgr-patch.txt",
        "scripts/gen_test_files.sh",
        "scripts/llsrc-vtpm-host0_pubek.bin",
        "scripts/llsrc-vtpm-host0_pubek.pem",
        "scripts/moc-new.bu.edu-pubek.pem",
        "scripts/moc01.bu.edu-pubek.pem",
        "scripts/test_check_quote.py",
        "scripts/test_check_quote_raw.py",
        "scripts/test_create_quote.py",
        "scripts/test_old_quote.py",
        "scripts/test_vtpm_register.sh",
        "setup.py"
      ],
      "insertions": 13529,
      "deletions": 45,
      "original_hash": "27f669fa3f754fc3f0d928b8849695af9fced5cb",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "bdf05d9fc431f740108a015aa49a7d6041b34d11",
      "author": "jetwhiz",
      "author_email": "charles.munson@ll.mit.edu",
      "committed_date": "2018-01-05T15:04:12-05:00",
      "message": "integration tests, CentOS installer support, improved STUB_TPM (+canned values), notes for using Xen vTPM, various bug fixes",
      "files_changed": [
        "README.md",
        "doc/keylime RESTful API.docx",
        "doc/xen-vtpm-notes.md",
        "installer.sh",
        "keylime.conf",
        "keylime/ca_util.py",
        "keylime/cloud_node.py",
        "keylime/cloud_verifier_common.py",
        "keylime/cloud_verifier_tornado.py",
        "keylime/common.py",
        "keylime/crypto.py",
        "keylime/dev-clean.sh",
        "keylime/ima.py",
        "keylime/keylime_sqlite.py",
        "keylime/make_node_bundle.sh",
        "keylime/make_node_bundle_tarball.sh",
        "keylime/provider_platform_init.py",
        "keylime/provider_vtpm_add.py",
        "keylime/registrar_client.py",
        "keylime/registrar_common.py",
        "keylime/revocation_actions/update_crl.py",
        "keylime/revocation_notifier.py",
        "keylime/tenant.py",
        "keylime/tenant_webapp.py",
        "keylime/tpm_cexec.py",
        "keylime/tpm_exec.py",
        "keylime/tpm_initialize.py",
        "keylime/tpm_nvram.py",
        "keylime/tpm_quote.py",
        "keylime/tpm_random.py",
        "keylime/vtpm_manager.py",
        "setup.py",
        "test-data/emulator-inputs.txt",
        "test-data/tpm-inputs.txt",
        "test-data/vtpm-inputs.txt",
        "test/__init__.py",
        "test/run_tests.sh",
        "test/test_restful.py"
      ],
      "insertions": 4147,
      "deletions": 808,
      "original_hash": "bdf05d9fc431f740108a015aa49a7d6041b34d11",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "b01e4f8dfcc3d1049ff1d8d6ea00163c22d08892",
      "author": "Thore Sommer",
      "author_email": "mail@thson.de",
      "committed_date": "2021-06-23T09:34:25-04:00",
      "message": "ima: Use ima_ast for parsing and validation\n\nUse the new introduced parser and validator capabilities to handle IMA\nvalidation.\n\nThis moves the parsing of the IMA entries out of the process_measurement_list\nfunction and validators unified where possible.\n\nAll unused code and comments related to parsing are removed.\n\nSigned-off-by: Thore Sommer <mail@thson.de>",
      "files_changed": [
        "keylime/ima.py"
      ],
      "insertions": 73,
      "deletions": 244,
      "original_hash": "b01e4f8dfcc3d1049ff1d8d6ea00163c22d08892",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "82819766cd49525d1ef484f1ea0f8422b7ce8451",
      "author": "Thore Sommer",
      "author_email": "mail@thson.de",
      "committed_date": "2021-12-15T09:53:49-05:00",
      "message": "ima: add option 'log_hash_alg' to IMA allowlist\n\nThis option control which hash algorithm is used for comparing the hash\ngiven in an IMA log entry.\n\nSigned-off-by: Thore Sommer <mail@thson.de>",
      "files_changed": [
        "keylime/ima.py"
      ],
      "insertions": 17,
      "deletions": 4,
      "original_hash": "82819766cd49525d1ef484f1ea0f8422b7ce8451",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "a3b0649353b5c64b0b54407508ee93bfd9ef306d",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.ibm.com",
      "committed_date": "2021-10-11T12:24:02-04:00",
      "message": "ima: Fix spurious attestation failures\n\nSince IMA log appending and PCR extensions are not atomic we can get into\nthe situation where we get a PCR quote that does not contain the PCR 10\ntaking into account the latest measurement. This can happen if there has\nbeen a single measurement added to the list. In this case we will not find\nthe matching PCR 10 when walking the measurement list but have to look for\na match before walking the measurement list.\n\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/ima.py"
      ],
      "insertions": 7,
      "deletions": 5,
      "original_hash": "a3b0649353b5c64b0b54407508ee93bfd9ef306d",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "1ce3fe734c757f9997f1bf95b18dcf3b445d4894",
      "author": "Thore Sommer",
      "author_email": "mail@thson.de",
      "committed_date": "2021-09-13T17:02:28-04:00",
      "message": "ima: move to new failure architecture\n\nPart of enhancement proposal https://github.com/keylime/enhancements/issues/48\n\nSigned-off-by: Thore Sommer <mail@thson.de>",
      "files_changed": [
        "keylime/ima.py",
        "keylime/ima_ast.py",
        "test/test_ima_ast.py",
        "test/test_ima_verification.py"
      ],
      "insertions": 100,
      "deletions": 50,
      "original_hash": "1ce3fe734c757f9997f1bf95b18dcf3b445d4894",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "11e26b7722a26d66eed80efa789fcbcfd70d87a3",
      "author": "Stefan Berger",
      "author_email": "stefanb@linux.vnet.ibm.com",
      "committed_date": "2020-11-23T16:11:28-05:00",
      "message": "ima: Move extraction from 'ima' and 'ima-ng' into their own functions\n\nSigned-off-by: Stefan Berger <stefanb@linux.ibm.com>",
      "files_changed": [
        "keylime/ima.py"
      ],
      "insertions": 73,
      "deletions": 41,
      "original_hash": "11e26b7722a26d66eed80efa789fcbcfd70d87a3",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    },
    {
      "hash": "7a394270965d19e674e1874685d56421e5f0a937",
      "author": "Patrick Uiterwijk",
      "author_email": "patrick@puiterwijk.org",
      "committed_date": "2021-02-24T09:32:15-05:00",
      "message": "Enable configuring REQUIRE_ROOT via environment\n\nSigned-off-by: Patrick Uiterwijk <patrick@puiterwijk.org>",
      "files_changed": [
        "keylime/config.py"
      ],
      "insertions": 16,
      "deletions": 1,
      "original_hash": "7a394270965d19e674e1874685d56421e5f0a937",
      "malicious_files": [
        "keylime/config.py",
        "keylime/ima.py"
      ]
    }
  ]
}