{
  "esp-v2": [
    {
      "hash": "59384e6f0a58a73beb51a169f2ea44ea0418cb7c",
      "author": "Teju Nareddy",
      "author_email": "nareddyt@google.com",
      "committed_date": "2019-08-02T16:36:44-07:00",
      "message": "b/137103344 #3: pass active root span down to the cache\n\nThe root span is needed in order to create and end child spans.\nBest method is to pass the root span down from `filter.cc`.\n\nTesting Done:\n- Modified unit tests\n- Unit tests and integration tests\n- Manual e2e test, viewable here: https://pantheon.corp.google.com/traces/traces?project=cloudesf-testing&q=span:\"Service%20Control\"\n\nChange-Id: Ia8c238bfc1fe33ae86b87f8a5cdc009a902ef3cd",
      "files_changed": [
        "src/envoy/http/service_control/BUILD",
        "src/envoy/http/service_control/client_cache.cc",
        "src/envoy/http/service_control/client_cache.h",
        "src/envoy/http/service_control/filter.cc",
        "src/envoy/http/service_control/filter_test.cc",
        "src/envoy/http/service_control/handler.h",
        "src/envoy/http/service_control/handler_impl.cc",
        "src/envoy/http/service_control/handler_impl.h",
        "src/envoy/http/service_control/handler_impl_test.cc",
        "src/envoy/http/service_control/mocks.h",
        "src/envoy/http/service_control/service_control_call.h",
        "src/envoy/http/service_control/service_control_call_impl.cc",
        "src/envoy/http/service_control/service_control_call_impl.h"
      ],
      "insertions": 171,
      "deletions": 94,
      "original_hash": "59384e6f0a58a73beb51a169f2ea44ea0418cb7c",
      "malicious_files": [
        "src/envoy/http/service_control/filter.cc"
      ]
    },
    {
      "hash": "7d4846be8bb76738f1f56a0dc731a0647786ec67",
      "author": "Wayne Zhang",
      "author_email": "qiwzhang@google.com",
      "committed_date": "2018-11-07T02:09:01+00:00",
      "message": "Add service control filter\n\nSigned-off-by: Wayne Zhang <844116644286-compute@developer.gserviceaccount.com>\nChange-Id: I985e53ebc8490c37ce45374b1746046ee008aa60",
      "files_changed": [
        "BUILD",
        "WORKSPACE",
        "googleapis.bzl",
        "protobuf.bzl",
        "repositories.bzl",
        "service_control.bzl",
        "src/envoy/http/cloudesf/BUILD",
        "src/envoy/http/cloudesf/README.md",
        "src/envoy/http/cloudesf/config.proto",
        "src/envoy/http/cloudesf/envoy.yaml",
        "src/envoy/http/cloudesf/filter.cc",
        "src/envoy/http/cloudesf/filter.h",
        "src/envoy/http/cloudesf/filter_config.h",
        "src/envoy/http/cloudesf/filter_factory.cc",
        "src/envoy/http/cloudesf/http_call.cc",
        "src/envoy/http/cloudesf/http_call.h",
        "src/envoy/http/cloudesf/service_control/BUILD",
        "src/envoy/http/cloudesf/service_control/info.h",
        "src/envoy/http/cloudesf/service_control/proto.cc",
        "src/envoy/http/cloudesf/service_control/proto.h",
        "src/envoy/http/cloudesf/service_control/proto_test.cc",
        "src/envoy/http/cloudesf/service_control/testdata/allocate_quota_request.golden",
        "src/envoy/http/cloudesf/service_control/testdata/allocate_quota_request_android_ios.golden",
        "src/envoy/http/cloudesf/service_control/testdata/allocate_quota_request_no_method_name.golden",
        "src/envoy/http/cloudesf/service_control/testdata/allocate_quota_request_without_api_key.golden",
        "src/envoy/http/cloudesf/service_control/testdata/allocate_quota_request_without_api_key_projectid.golden",
        "src/envoy/http/cloudesf/service_control/testdata/check_request.golden",
        "src/envoy/http/cloudesf/service_control/testdata/check_request_android_ios.golden",
        "src/envoy/http/cloudesf/service_control/testdata/check_request_no_api_key.golden",
        "src/envoy/http/cloudesf/service_control/testdata/final_report_request.golden",
        "src/envoy/http/cloudesf/service_control/testdata/first_report_request.golden",
        "src/envoy/http/cloudesf/service_control/testdata/intermediate_report_request.golden",
        "src/envoy/http/cloudesf/service_control/testdata/report_request.golden",
        "src/envoy/http/cloudesf/service_control/testdata/report_request_by_consumer.golden",
        "src/envoy/http/cloudesf/service_control/testdata/report_request_empty_optional.golden",
        "src/envoy/http/cloudesf/service_control/testdata/report_request_failed.golden",
        "src/envoy/http/cloudesf/token_fetcher.cc",
        "src/envoy/http/cloudesf/token_fetcher.h"
      ],
      "insertions": 6381,
      "deletions": 3,
      "original_hash": "7d4846be8bb76738f1f56a0dc731a0647786ec67",
      "malicious_files": [
        "src/envoy/http/service_control/filter.cc"
      ]
    },
    {
      "hash": "fa969ee48a283486b513299d991f4b8865a5cedf",
      "author": "Teju Nareddy",
      "author_email": "nareddyt@google.com",
      "committed_date": "2020-10-14T14:51:08-04:00",
      "message": "b/170679093: Format with `clang-format-10` (#381)\n\nNo other changes in this PR other than formatting with `clang-format-10`.\r\n\r\nSigned-off-by: Teju Nareddy <nareddyt@google.com>",
      "files_changed": [
        "api/envoy/v9/http/grpc_metadata_scrubber/config.proto",
        "src/api_proxy/path_matcher/http_template.cc",
        "src/api_proxy/path_matcher/http_template_fuzz_test.cc",
        "src/api_proxy/path_matcher/http_template_test.cc",
        "src/api_proxy/path_matcher/path_matcher_node.cc",
        "src/api_proxy/service_control/logs_metrics_loader.cc",
        "src/api_proxy/service_control/logs_metrics_loader_test.cc",
        "src/api_proxy/service_control/request_builder.cc",
        "src/api_proxy/service_control/request_builder.h",
        "src/api_proxy/service_control/request_builder_test.cc",
        "src/api_proxy/service_control/request_info.h",
        "src/envoy/http/backend_auth/config_parser_impl.cc",
        "src/envoy/http/backend_auth/config_parser_impl_test.cc",
        "src/envoy/http/backend_routing/filter_fuzz_test.cc",
        "src/envoy/http/grpc_metadata_scrubber/filter.cc",
        "src/envoy/http/grpc_metadata_scrubber/filter.h",
        "src/envoy/http/grpc_metadata_scrubber/filter_factory.cc",
        "src/envoy/http/grpc_metadata_scrubber/filter_test.cc",
        "src/envoy/http/path_matcher/filter.cc",
        "src/envoy/http/path_matcher/filter.h",
        "src/envoy/http/path_matcher/filter_config.cc",
        "src/envoy/http/path_matcher/filter_config_test.cc",
        "src/envoy/http/path_matcher/filter_factory.cc",
        "src/envoy/http/path_matcher/filter_fuzz_test.cc",
        "src/envoy/http/path_matcher/filter_test.cc",
        "src/envoy/http/service_control/client_cache.cc",
        "src/envoy/http/service_control/client_cache_test.cc",
        "src/envoy/http/service_control/config_parser.h",
        "src/envoy/http/service_control/config_parser_test.cc",
        "src/envoy/http/service_control/filter.cc",
        "src/envoy/http/service_control/filter.h",
        "src/envoy/http/service_control/filter_factory.cc",
        "src/envoy/http/service_control/filter_fuzz_test.cc",
        "src/envoy/http/service_control/filter_stats.cc",
        "src/envoy/http/service_control/filter_stats_test.cc",
        "src/envoy/http/service_control/filter_test.cc",
        "src/envoy/http/service_control/handler_impl.cc",
        "src/envoy/http/service_control/handler_impl_test.cc",
        "src/envoy/http/service_control/handler_utils.cc",
        "src/envoy/http/service_control/http_call_test.cc",
        "src/envoy/http/service_control/service_control_callback_func.h",
        "src/envoy/token/iam_token_info_fuzz_test.cc",
        "src/envoy/token/imds_token_info.cc",
        "src/envoy/token/imds_token_info_fuzz_test.cc",
        "src/envoy/token/token_subscriber.cc",
        "src/envoy/token/token_subscriber_test.cc",
        "src/envoy/utils/http_header_utils.cc",
        "src/envoy/utils/http_header_utils_test.cc",
        "src/envoy/utils/json_struct.cc",
        "src/envoy/utils/json_struct_fuzz_test.cc",
        "src/envoy/utils/rc_detail_utils.cc",
        "src/envoy/utils/rc_detail_utils.h"
      ],
      "insertions": 109,
      "deletions": 112,
      "original_hash": "fa969ee48a283486b513299d991f4b8865a5cedf",
      "malicious_files": [
        "src/envoy/http/service_control/filter.cc"
      ]
    },
    {
      "hash": "58a43460eed320c07a2fc480dc1ab7241580ef9a",
      "author": "Wayne Zhang",
      "author_email": "qiwzhang@google.com",
      "committed_date": "2019-01-11T03:38:29+00:00",
      "message": "Fetch token at config thread\n\nSigned-off-by: Wayne Zhang <844116644286-compute@developer.gserviceaccount.com>\nChange-Id: Ife3d2cfc642b021d6d9521d5319772c25a110079",
      "files_changed": [
        "src/envoy/http/service_control/BUILD",
        "src/envoy/http/service_control/config_parser.h",
        "src/envoy/http/service_control/envoy.yaml",
        "src/envoy/http/service_control/filter.cc",
        "src/envoy/http/service_control/filter.h",
        "src/envoy/http/service_control/token_cache.h",
        "src/envoy/http/service_control/token_fetcher.cc",
        "src/envoy/http/service_control/token_fetcher.h",
        "src/envoy/http/service_control/token_subscriber.cc",
        "src/envoy/http/service_control/token_subscriber.h",
        "src/envoy/http/service_control/token_subscriber_test.cc"
      ],
      "insertions": 398,
      "deletions": 259,
      "original_hash": "58a43460eed320c07a2fc480dc1ab7241580ef9a",
      "malicious_files": [
        "src/envoy/http/service_control/filter.cc"
      ]
    },
    {
      "hash": "aee808054adcf9244859ff0ecab8d905f8716267",
      "author": "Wayne Zhang",
      "author_email": "qiwzhang@google.com",
      "committed_date": "2019-11-22T17:27:15+00:00",
      "message": "Add cancelation for inflight check call\n\nChange-Id: I9969754a91c60b351b5244228423b7719b5a3d36",
      "files_changed": [
        "src/envoy/http/service_control/client_cache.cc",
        "src/envoy/http/service_control/client_cache.h",
        "src/envoy/http/service_control/filter.cc",
        "src/envoy/http/service_control/filter.h",
        "src/envoy/http/service_control/filter_test.cc",
        "src/envoy/http/service_control/handler.h",
        "src/envoy/http/service_control/handler_impl.cc",
        "src/envoy/http/service_control/handler_impl.h",
        "src/envoy/http/service_control/handler_impl_test.cc",
        "src/envoy/http/service_control/mocks.h",
        "src/envoy/http/service_control/service_control_call.h",
        "src/envoy/http/service_control/service_control_call_impl.cc",
        "src/envoy/http/service_control/service_control_call_impl.h",
        "src/envoy/http/service_control/service_control_callback_func.h"
      ],
      "insertions": 136,
      "deletions": 52,
      "original_hash": "aee808054adcf9244859ff0ecab8d905f8716267",
      "malicious_files": [
        "src/envoy/http/service_control/filter.cc"
      ]
    },
    {
      "hash": "6b76bb683ea49b71c34a1f9866a9a9586449c966",
      "author": "Xuyang Tao",
      "author_email": "taoxuy@google.com",
      "committed_date": "2020-12-28T09:14:55-08:00",
      "message": "b/173024112: #1 move the NOT_FOUND rejection logic to router (#446)",
      "files_changed": [
        "examples/auth/envoy_config.json",
        "examples/dynamic_routing/envoy_config.json",
        "examples/grpc_dynamic_routing/envoy_config.json",
        "examples/service_control/envoy_config.json",
        "examples/testdata/route_match/envoy_config.json",
        "examples/testdata/sidecar_backend/envoy_config.json",
        "src/envoy/http/backend_auth/README.md",
        "src/envoy/http/backend_auth/filter.cc",
        "src/envoy/http/backend_auth/filter_test.cc",
        "src/envoy/http/path_rewrite/README.md",
        "src/envoy/http/path_rewrite/filter.cc",
        "src/envoy/http/path_rewrite/filter_test.cc",
        "src/envoy/http/service_control/BUILD",
        "src/envoy/http/service_control/filter.cc",
        "src/envoy/http/service_control/filter_test.cc",
        "src/envoy/http/service_control/handler_impl.cc",
        "src/envoy/http/service_control/handler_impl_test.cc",
        "src/go/configgenerator/listener_generator_test.go",
        "src/go/configgenerator/route_generator.go",
        "src/go/configgenerator/route_generator_test.go",
        "src/go/configmanager/testdata/test_fetch_listeners.go",
        "src/go/configmanager/testdata/test_fixed_mode_dynamic_routing.go",
        "tests/integration_test/access_log_test.go",
        "tests/integration_test/opencensus_tracing_test.go",
        "tests/integration_test/service_control_failed_request_report_test.go"
      ],
      "insertions": 573,
      "deletions": 247,
      "original_hash": "6b76bb683ea49b71c34a1f9866a9a9586449c966",
      "malicious_files": [
        "src/envoy/http/service_control/filter.cc"
      ]
    },
    {
      "hash": "4fa84e38840bc587d114d42b91537b2d4f955a29",
      "author": "Wayne Zhang",
      "author_email": "qiwzhang@google.com",
      "committed_date": "2019-02-16T01:04:23+00:00",
      "message": "Split service control filter code\n\nSo that if decodeHeader is NOT called, it is easier to\ncollected request data for Report.\n\nChange-Id: Id3dcf0a50cb785ec33cfa5b90959e1f0401348ab",
      "files_changed": [
        "src/envoy/http/service_control/BUILD",
        "src/envoy/http/service_control/filter.cc",
        "src/envoy/http/service_control/filter.h",
        "src/envoy/http/service_control/handler.cc",
        "src/envoy/http/service_control/handler.h"
      ],
      "insertions": 378,
      "deletions": 233,
      "original_hash": "4fa84e38840bc587d114d42b91537b2d4f955a29",
      "malicious_files": [
        "src/envoy/http/service_control/filter.cc"
      ]
    },
    {
      "hash": "6015d9c07d6e1c00531af36333156ad65e847704",
      "author": "Todd Beckman",
      "author_email": "toddbeckman@google.com",
      "committed_date": "2019-04-08T09:34:57-06:00",
      "message": "Unit tests for ServiceControlFilter\n\n- Convert Handler into an Interface\n- Rename Filter and Handler to ServiceControl* for readability\n\nChange-Id: I31e5b22d29deb874e0cbd311b191b8d8da24b95b",
      "files_changed": [
        "src/envoy/http/service_control/BUILD",
        "src/envoy/http/service_control/filter.cc",
        "src/envoy/http/service_control/filter.h",
        "src/envoy/http/service_control/filter_config.h",
        "src/envoy/http/service_control/filter_factory.cc",
        "src/envoy/http/service_control/filter_test.cc",
        "src/envoy/http/service_control/handler.cc",
        "src/envoy/http/service_control/handler.h",
        "src/envoy/http/service_control/handler_impl.cc",
        "src/envoy/http/service_control/handler_impl.h",
        "src/envoy/http/service_control/mocks.h",
        "tests/e2e/client/apiproxy_bookstore_test.py",
        "tests/integration/cors_integration_test.go",
        "tests/integration/service_control_test.go"
      ],
      "insertions": 931,
      "deletions": 525,
      "original_hash": "6015d9c07d6e1c00531af36333156ad65e847704",
      "malicious_files": [
        "src/envoy/http/service_control/filter.cc"
      ]
    },
    {
      "hash": "b92ae480d905f47b7fb42cd774e0506916f747d5",
      "author": "Wayne Zhang",
      "author_email": "qiwzhang@google.com",
      "committed_date": "2020-10-12T14:38:52-07:00",
      "message": "Use per-route config for ServiceControl filter (#368)\n\n* service control per-route-config envoy change\r\n\r\nSigned-off-by: Wayne Zhang <qiwzhang@google.com>\r\n\r\n* change config-mgr\r\n\r\nSigned-off-by: Wayne Zhang <qiwzhang@google.com>\r\n\r\n* fix unit-tests\r\n\r\nSigned-off-by: Wayne Zhang <qiwzhang@google.com>\r\n\r\n* Fix integration tests\r\n\r\nSigned-off-by: Wayne Zhang <qiwzhang@google.com>\r\n\r\n* fix another test\r\n\r\nSigned-off-by: Wayne Zhang <qiwzhang@google.com>\r\n\r\n* add more tests for http method and path\r\n\r\nSigned-off-by: Wayne Zhang <qiwzhang@google.com>",
      "files_changed": [
        "api/envoy/v9/http/service_control/config.proto",
        "examples/auth/envoy_config.json",
        "examples/dynamic_routing/envoy_config.json",
        "examples/grpc_dynamic_routing/envoy_config.json",
        "examples/service_control/envoy_config.json",
        "examples/testdata/path_matcher/envoy_config.json",
        "examples/testdata/sidecar_backend/envoy_config.json",
        "src/envoy/http/service_control/BUILD",
        "src/envoy/http/service_control/config_parser.h",
        "src/envoy/http/service_control/filter.cc",
        "src/envoy/http/service_control/filter_factory.cc",
        "src/envoy/http/service_control/filter_test.cc",
        "src/envoy/http/service_control/handler_impl.cc",
        "src/envoy/http/service_control/handler_impl.h",
        "src/envoy/http/service_control/handler_impl_test.cc",
        "src/go/configgenerator/route_generator.go",
        "src/go/configgenerator/route_generator_test.go",
        "src/go/configmanager/testdata/test_fetch_listeners.go",
        "src/go/configmanager/testdata/test_fixed_mode_dynamic_routing.go",
        "src/go/util/marshal.go",
        "tests/env/components/stats_verifier.go",
        "tests/env/testdata/fake_echo_service_config.go",
        "tests/integration_test/managed_service_config_test.go"
      ],
      "insertions": 550,
      "deletions": 76,
      "original_hash": "b92ae480d905f47b7fb42cd774e0506916f747d5",
      "malicious_files": [
        "src/envoy/http/service_control/filter.cc"
      ]
    },
    {
      "hash": "cf19b8880b49351d8f0d47298b1ea4bce3bf1788",
      "author": "Wayne Zhang",
      "author_email": "qiwzhang@google.com",
      "committed_date": "2019-01-05T00:04:50+00:00",
      "message": "Clean up config_parser\n\nSigned-off-by: Wayne Zhang <844116644286-compute@developer.gserviceaccount.com>\nChange-Id: I7e58bcd33f423e820d04674b4c7b35d31386622e\nSigned-off-by: Wayne Zhang <844116644286-compute@developer.gserviceaccount.com>",
      "files_changed": [
        "src/envoy/http/service_control/BUILD",
        "src/envoy/http/service_control/config_parser.cc",
        "src/envoy/http/service_control/config_parser.h",
        "src/envoy/http/service_control/config_parser_test.cc",
        "src/envoy/http/service_control/filter.cc",
        "src/envoy/http/service_control/filter.h",
        "src/envoy/http/service_control/filter_config.h",
        "src/envoy/http/service_control/path_matcher.h"
      ],
      "insertions": 147,
      "deletions": 329,
      "original_hash": "cf19b8880b49351d8f0d47298b1ea4bce3bf1788",
      "malicious_files": [
        "src/envoy/http/service_control/filter.cc"
      ]
    },
    {
      "hash": "c584700eb24eac179ff99679609865c8f6264251",
      "author": "Connor Douthat",
      "author_email": "cdouthat@google.com",
      "committed_date": "2019-04-12T12:35:16-06:00",
      "message": "Send streaming Reports in decodeData\n\nChange-Id: I4e6f468daf9fe173d85652bfa7d5de30b8ab41d5",
      "files_changed": [
        "api/envoy/http/service_control/config.proto",
        "src/api_proxy/service_control/BUILD",
        "src/api_proxy/service_control/request_builder.cc",
        "src/api_proxy/service_control/request_builder.h",
        "src/api_proxy/service_control/request_info.h",
        "src/api_proxy/utils/BUILD",
        "src/envoy/http/service_control/config_parser.h",
        "src/envoy/http/service_control/filter.cc",
        "src/envoy/http/service_control/filter_test.cc",
        "src/envoy/http/service_control/handler.h",
        "src/envoy/http/service_control/handler_impl.cc",
        "src/envoy/http/service_control/handler_impl.h",
        "src/envoy/http/service_control/mocks.h",
        "src/go/proto/api/envoy/http/service_control/config.pb.go"
      ],
      "insertions": 274,
      "deletions": 118,
      "original_hash": "c584700eb24eac179ff99679609865c8f6264251",
      "malicious_files": [
        "src/envoy/http/service_control/filter.cc"
      ]
    }
  ]
}